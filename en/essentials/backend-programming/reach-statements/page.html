<p>This page defines Reach statements, blocks, tails, continuations, block statements, and terminator statements, and lists and describes the statement identifiers supported by Reach.</p>
<blockquote>
  <p>Note that some statement identifiers are valid only in certain <a href="/en/essentials/backend-programming/reach-modes/">Reach Modes</a>. For example, <code>setOptions</code> and <code>deploy</code> are valid only during <a href="/en/essentials/backend-programming/reach-modes/#initialization">Initialization</a>, <code>fork</code> and <code>exit</code> are valid only in <a href="/en/essentials/backend-programming/reach-modes/#step">Steps</a>, and <code>commit</code> is valid only in <a href="/en/essentials/backend-programming/reach-modes/#consensus-step">Consensus Steps</a>.</p>
</blockquote>
<h3 id="statements">Statements<a aria-hidden="true" tabindex="-1" href="#statements"><span class="icon icon-link"></span></a></h3>
<p><em>Statements</em> are instructions composed of identifiers, operators, and expressions. Statements often begin with an identifier (e.g. <code>const</code>) and end with a semicolon:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">wager</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #8250DF">declassify</span><span style="color: #24292F">(interact.wager);</span></li></ol></pre>
<p>Conditional statements, which begin with the identifier <code>if</code>, do not end with a semicolon:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #CF222E">if</span><span style="color: #24292F"> (</span><span style="color: #CF222E">!</span><span style="color: #24292F">willBuy) {</span></li><li value="2"><span style="color: #24292F">  </span><span style="color: #8250DF">commit</span><span style="color: #24292F">();</span></li><li value="3"><span style="color: #24292F">  </span><span style="color: #8250DF">each</span><span style="color: #24292F">([</span><span style="color: #0550AE">S</span><span style="color: #24292F">, </span><span style="color: #0550AE">B</span><span style="color: #24292F">], () </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> interact.</span><span style="color: #8250DF">reportCancellation</span><span style="color: #24292F">());</span></li><li value="4"><span style="color: #24292F">  </span><span style="color: #8250DF">exit</span><span style="color: #24292F">();</span></li><li value="5"><span style="color: #24292F">}</span></li></ol></pre>
<h3 id="blocks">Blocks<a aria-hidden="true" tabindex="-1" href="#blocks"><span class="icon icon-link"></span></a></h3>
<p><em>Blocks</em> are sequences of statements surrounded by curly braces. Below are five blocks. The third contains the fourth and fifth:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #24292F">{ </span><span style="color: #CF222E">return</span><span style="color: #24292F"> </span><span style="color: #0550AE">42</span><span style="color: #24292F">; }</span></li><li value="2"></li><li value="3"><span style="color: #24292F">{</span></li><li value="4"><span style="color: #24292F">  </span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">x</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #0550AE">31</span><span style="color: #24292F">;</span></li><li value="5"><span style="color: #24292F">  </span><span style="color: #CF222E">return</span><span style="color: #24292F"> x </span><span style="color: #CF222E">+</span><span style="color: #24292F"> </span><span style="color: #0550AE">11</span><span style="color: #24292F">;</span></li><li value="6"><span style="color: #24292F">}</span></li><li value="7"></li><li value="8"><span style="color: #24292F">{ </span></li><li value="9"><span style="color: #24292F">  </span><span style="color: #CF222E">if</span><span style="color: #24292F"> ( x </span><span style="color: #CF222E">&lt;</span><span style="color: #24292F"> y ) {</span></li><li value="10"><span style="color: #24292F">    </span><span style="color: #CF222E">return</span><span style="color: #24292F"> </span><span style="color: #0A3069">'Why'</span><span style="color: #24292F">;</span></li><li value="11"><span style="color: #24292F">  } </span><span style="color: #CF222E">else</span><span style="color: #24292F"> {</span></li><li value="12"><span style="color: #24292F">    </span><span style="color: #CF222E">return</span><span style="color: #24292F"> </span><span style="color: #0A3069">'Ecks'</span><span style="color: #24292F">;</span></li><li value="13"><span style="color: #24292F">  }</span></li><li value="14"><span style="color: #24292F">}</span></li></ol></pre>
<h3 id="tails">Tails<a aria-hidden="true" tabindex="-1" href="#tails"><span class="icon icon-link"></span></a></h3>
<p><em>Tails</em> are statements that follow a prior statement within the same scope. Consider the following:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #24292F">{</span></li><li value="2"><span style="color: #24292F">  </span><span style="color: #0550AE">X</span><span style="color: #24292F">;</span></li><li value="3"><span style="color: #24292F">  </span><span style="color: #0550AE">Y</span><span style="color: #24292F">;</span></li><li value="4"><span style="color: #24292F">  </span><span style="color: #0550AE">Z</span><span style="color: #24292F">;</span></li><li value="5"><span style="color: #24292F">}</span></li></ol></pre>
<p>In this block, the tail of statement <code>X</code> is <code>{ Y; Z; }</code>, and the tail of statement <code>Y</code> is <code>{ Z; }</code>. Tails are statically apparent from the structure of the source code.</p>
<h3 id="continuations">Continuations<a aria-hidden="true" tabindex="-1" href="#continuations"><span class="icon icon-link"></span></a></h3>
<p><em>Continuations</em> are all the statements that follow a prior statement. Consider the following:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #24292F">{ </span></li><li value="2"><span style="color: #24292F">  {</span></li><li value="3"><span style="color: #24292F">    </span><span style="color: #0550AE">X</span><span style="color: #24292F">;</span></li><li value="4"><span style="color: #24292F">    </span><span style="color: #0550AE">Y</span><span style="color: #24292F">;</span></li><li value="5"><span style="color: #24292F">  };</span></li><li value="6"><span style="color: #24292F">  </span><span style="color: #0550AE">Z</span><span style="color: #24292F">;</span></li><li value="7"><span style="color: #24292F">}</span></li></ol></pre>
<p>In this block, the continuation of statement <code>X</code> is <code>{ Y; }; Z;</code>. Continuations are not statically apparent. On the contrary, continuations are influenced by function calls.</p>
<h3 id="block-statements">Block Statements<a aria-hidden="true" tabindex="-1" href="#block-statements"><span class="icon icon-link"></span></a></h3>
<p><em>Block statements</em>, statements composed of blocks, establish a local scope for the identifier definitions within the curly braces, isolating the definitions from the statement tail. Consider this example that does <em>not</em> include a block statement:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">x</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #0550AE">4</span><span style="color: #24292F">;</span></li><li value="2"><span style="color: #CF222E">return</span><span style="color: #24292F"> x;</span></li></ol></pre>
<p>Above, <code>x</code> evaluates to <code>4</code>. The snippet below isolates <code>const x = 4</code> within a block statement:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #24292F">{ </span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">x</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #0550AE">4</span><span style="color: #24292F">; }</span></li><li value="2"><span style="color: #CF222E">return</span><span style="color: #24292F"> x;</span></li></ol></pre>
<p>Now, <code>return x</code> is erroneous because <code>x</code> is unbound outside the block statement.</p>
<h3 id="terminator-statements">Terminator Statements<a aria-hidden="true" tabindex="-1" href="#terminator-statements"><span class="icon icon-link"></span></a></h3>
<p><em>Terminator statements</em> are statements with no tail. Consider the following:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #24292F">{</span></li><li value="2"><span style="color: #24292F">  </span><span style="color: #0550AE">X</span><span style="color: #24292F">;</span></li><li value="3"><span style="color: #24292F">  </span><span style="color: #0550AE">Y</span><span style="color: #24292F">;</span></li><li value="4"><span style="color: #24292F">  </span><span style="color: #0550AE">Z</span><span style="color: #24292F">;</span></li><li value="5"><span style="color: #24292F">}</span></li></ol></pre>
<p>In this block, <code>Z</code> is the terminator statement because it does not have a tail. Blocks that end with <code>return</code>, <code>continue</code>, or <code>exit</code> do not have terminator statements. The compiler treats these types of blocks as if they end with <code>return null</code>.</p>
<h1 id="commit">commit<a aria-hidden="true" tabindex="-1" href="#commit"><span class="icon icon-link"></span></a></h1>
<h1 id="const">const<a aria-hidden="true" tabindex="-1" href="#const"><span class="icon icon-link"></span></a></h1>
<p><code>const</code> is an <em>identifier definition</em> that binds an identifier to a <em>value</em> definition. Here are examples:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">DELAY</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #0550AE">10</span><span style="color: #24292F">;</span></li><li value="2"><span style="color: #CF222E">const</span><span style="color: #24292F"> [ </span><span style="color: #0550AE">Good</span><span style="color: #24292F">, </span><span style="color: #0550AE">Bad</span><span style="color: #24292F"> ] </span><span style="color: #CF222E">=</span><span style="color: #24292F"> [ </span><span style="color: #0550AE">42</span><span style="color: #24292F">, </span><span style="color: #0550AE">43</span><span style="color: #24292F"> ];</span></li><li value="3"><span style="color: #CF222E">const</span><span style="color: #24292F"> { </span><span style="color: #0550AE">x</span><span style="color: #24292F">, </span><span style="color: #0550AE">y</span><span style="color: #24292F"> } </span><span style="color: #CF222E">=</span><span style="color: #24292F"> { x: </span><span style="color: #0550AE">1</span><span style="color: #24292F">, y: </span><span style="color: #0550AE">2</span><span style="color: #24292F"> };</span></li><li value="4"><span style="color: #CF222E">const</span><span style="color: #24292F"> [ </span><span style="color: #0550AE">x</span><span style="color: #24292F">, [ </span><span style="color: #0550AE">y</span><span style="color: #24292F"> ] ] </span><span style="color: #CF222E">=</span><span style="color: #24292F"> [ </span><span style="color: #0550AE">1</span><span style="color: #24292F">, [ </span><span style="color: #0550AE">2</span><span style="color: #24292F"> ] ];</span></li><li value="5"><span style="color: #CF222E">const</span><span style="color: #24292F"> [ </span><span style="color: #0550AE">x</span><span style="color: #24292F">, { </span><span style="color: #0550AE">y</span><span style="color: #24292F"> } ] </span><span style="color: #CF222E">=</span><span style="color: #24292F"> [ </span><span style="color: #0550AE">1</span><span style="color: #24292F">, { y: </span><span style="color: #0550AE">2</span><span style="color: #24292F"> } ];</span></li><li value="6"><span style="color: #CF222E">const</span><span style="color: #24292F"> { </span><span style="color: #953800">x</span><span style="color: #24292F">: [ </span><span style="color: #0550AE">a</span><span style="color: #24292F">, </span><span style="color: #0550AE">b</span><span style="color: #24292F"> ] } </span><span style="color: #CF222E">=</span><span style="color: #24292F"> { x: [ </span><span style="color: #0550AE">1</span><span style="color: #24292F">, </span><span style="color: #0550AE">2</span><span style="color: #24292F"> ] };</span></li></ol></pre>
<p>You cannot re-bind a previously bound identifier. The following is invalid:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">x</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #0550AE">3</span><span style="color: #24292F">;</span></li><li value="2"><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">x</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #0550AE">4</span><span style="color: #24292F">; </span><span style="color: #6E7781">// invalid</span></li></ol></pre>
<p>The following is also invalid:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #24292F">Alice.</span><span style="color: #8250DF">only</span><span style="color: #24292F">(() </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> { </span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">x</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #0550AE">3</span><span style="color: #24292F">; });</span></li><li value="2"><span style="color: #24292F">Bob.</span><span style="color: #8250DF">only</span><span style="color: #24292F">(() </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> { </span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">x</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #0550AE">4</span><span style="color: #24292F">; }); </span><span style="color: #6E7781">// invalid</span></li></ol></pre>
<p>The special identifier <code>_</code> is an exception to this rule. The <code>_</code> binding is always considered to be unbound. This means that <code>_</code> is both an identifier that can never be read, as well as an identifier that may be bound many times which is useful for ignoring unwanted values. The following, for example, binds <code>x = 2</code> while ignoring <code>1</code> and <code>3</code>:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #CF222E">const</span><span style="color: #24292F"> [</span><span style="color: #0550AE">_</span><span style="color: #24292F">, </span><span style="color: #0550AE">x</span><span style="color: #24292F">, </span><span style="color: #0550AE">_</span><span style="color: #24292F">] </span><span style="color: #CF222E">=</span><span style="color: #24292F"> [</span><span style="color: #0550AE">1</span><span style="color: #24292F">, </span><span style="color: #0550AE">2</span><span style="color: #24292F">, </span><span style="color: #0550AE">3</span><span style="color: #24292F">];</span></li></ol></pre>
<h1 id="continue">continue<a aria-hidden="true" tabindex="-1" href="#continue"><span class="icon icon-link"></span></a></h1>
<h1 id="deploy">deploy<a aria-hidden="true" tabindex="-1" href="#deploy"><span class="icon icon-link"></span></a></h1>
<p>The <code>deploy</code> statement transitions from Initialization Mode to Step Mode. See <a href="/en/essentials/backend-programming/reach-modes/">Reach Modes</a>.</p>
<h1 id="each">each<a aria-hidden="true" tabindex="-1" href="#each"><span class="icon icon-link"></span></a></h1>
<p>See <a href="#only">only</a>.</p>
<h1 id="exit">exit<a aria-hidden="true" tabindex="-1" href="#exit"><span class="icon icon-link"></span></a></h1>
<p>The <code>exit</code> statement halts the computation. It is a terminator statement, so it must have an empty tail:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #8250DF">exit</span><span style="color: #24292F">();</span></li></ol></pre>
<h1 id="export">export<a aria-hidden="true" tabindex="-1" href="#export"><span class="icon icon-link"></span></a></h1>
<h1 id="fork">fork<a aria-hidden="true" tabindex="-1" href="#fork"><span class="icon icon-link"></span></a></h1>
<p>A <code>fork</code> statement organizes a competition among several participants (each intent on accomplishing a potentially different task), determines which participant wins the competition, and executes the winner's task. Here is the declaration:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #8250DF">fork</span><span style="color: #24292F">()</span></li><li value="2"><span style="color: #24292F">  .</span><span style="color: #8250DF">paySpec</span><span style="color: #24292F">(</span><span style="color: #0550AE">TOKENS_EXPR</span><span style="color: #24292F">)</span></li><li value="3"><span style="color: #24292F">  .</span><span style="color: #8250DF">case</span><span style="color: #24292F">(</span><span style="color: #0550AE">PART_EXPR</span><span style="color: #24292F">,</span></li><li value="4"><span style="color: #24292F">    </span><span style="color: #0550AE">PUBLISH_EXPR</span><span style="color: #24292F">,</span></li><li value="5"><span style="color: #24292F">    </span><span style="color: #0550AE">PAY_EXPR</span><span style="color: #24292F">,</span></li><li value="6"><span style="color: #24292F">    </span><span style="color: #0550AE">CONSENSUS_EXPR</span><span style="color: #24292F">)</span></li><li value="7"><span style="color: #24292F">  .</span><span style="color: #8250DF">api</span><span style="color: #24292F">(</span><span style="color: #0550AE">API_EXPR</span><span style="color: #24292F">,</span></li><li value="8"><span style="color: #24292F">    </span><span style="color: #0550AE">API_ASSUME_EXPR</span><span style="color: #24292F">,</span></li><li value="9"><span style="color: #24292F">    </span><span style="color: #0550AE">API_PAY_EXPR</span><span style="color: #24292F">,</span></li><li value="10"><span style="color: #24292F">    </span><span style="color: #0550AE">API_CONSENSUS_EXPR</span><span style="color: #24292F">)</span></li><li value="11"><span style="color: #24292F">  .</span><span style="color: #8250DF">timeout</span><span style="color: #24292F">(</span><span style="color: #0550AE">DELAY_EXPR</span><span style="color: #24292F">, () </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> </span><span style="color: #0550AE">TIMEOUT_BLOCK</span><span style="color: #24292F">);</span></li><li value="12"><span style="color: #24292F">  </span><span style="color: #6E7781">// or</span></li><li value="13"><span style="color: #24292F">  .</span><span style="color: #8250DF">throwTimeout</span><span style="color: #24292F">(</span><span style="color: #0550AE">DELAY_EXPR</span><span style="color: #24292F">, </span><span style="color: #0550AE">THROW_EXPR</span><span style="color: #24292F">)</span></li></ol></pre>
<ul>
  <li><code>TOKENS_EXPR</code> is an expression that evaluates to a tuple of Tokens;</li>
  <li><code>PART_EXPR</code> is an expression that evaluates to a participant;</li>
  <li><code>PUBLISH_EXPR</code> is a syntactic arrow expression that is evaluated in a local step for the specified participant and must evaluate to an object that may contain a msg field, which may be of any type, and a when field, which must be a boolean;</li>
  <li>(optional) <code>PAY_EXPR</code> is an expression that evaluates to a function parameterized over the msg value and returns a <a href="/en/books/essentials/terminology/#pay-amount">pay amount</a>; if this component is left-out, it is synthesized to zero;</li>
  <li><code>CONSENSUS_EXPR</code> is a syntactic arrow expression parameterized over the msg value which is evaluated in a consensus step;</li>
  <li><code>API_EXPR</code> is an expression that evaluates to an API member function;</li>
  <li>(optional) <code>API_ASSUME_EXPR</code> is a function parameterized over the input to the API member function which is evaluated for effect in a local step; thus it may be used to add assume constraints on the values given by the API; if this is absent, then it is synthesized to an empty function; if it is present, then API_PAY_EXPR must be included;</li>
  <li>(optional) <code>API_PAY_EXPR</code> is a function parameterized over the input to the API member function which is evaluated to determine the <a href="/en/books/essentials/terminology/#pay-amount">pay amount</a>, like PAY_EXPR;</li>
  <li><code>API_CONSENSUS_EXPR</code> is a function parameterized over the input to the API member function and a function that returns a value to the API call; this function must be called;</li>
  <li>the timeout and throwTimeout parameter are as in an consensus transfer.</li>
</ul>
<p>Here is an example:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #8250DF">fork</span><span style="color: #24292F">()</span></li><li value="2"><span style="color: #24292F">.</span><span style="color: #8250DF">case</span><span style="color: #24292F">(Alice, (() </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> ({</span></li><li value="3"><span style="color: #24292F">  msg: </span><span style="color: #0550AE">19</span><span style="color: #24292F">,</span></li><li value="4"><span style="color: #24292F">  when: </span><span style="color: #8250DF">declassify</span><span style="color: #24292F">(interact.</span><span style="color: #8250DF">keepGoing</span><span style="color: #24292F">()) })),</span></li><li value="5"><span style="color: #24292F">  ((</span><span style="color: #953800">v</span><span style="color: #24292F">) </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> v),</span></li><li value="6"><span style="color: #24292F">  (</span><span style="color: #953800">v</span><span style="color: #24292F">) </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> {</span></li><li value="7"><span style="color: #24292F">    </span><span style="color: #0550AE">require</span><span style="color: #24292F">(v </span><span style="color: #CF222E">==</span><span style="color: #24292F"> </span><span style="color: #0550AE">19</span><span style="color: #24292F">);</span></li><li value="8"><span style="color: #24292F">    </span><span style="color: #8250DF">transfer</span><span style="color: #24292F">(wager </span><span style="color: #CF222E">+</span><span style="color: #24292F"> </span><span style="color: #0550AE">19</span><span style="color: #24292F">).</span><span style="color: #8250DF">to</span><span style="color: #24292F">(</span><span style="color: #0550AE">this</span><span style="color: #24292F">);</span></li><li value="9"><span style="color: #24292F">    </span><span style="color: #8250DF">commit</span><span style="color: #24292F">();</span></li><li value="10"><span style="color: #24292F">    </span><span style="color: #8250DF">exit</span><span style="color: #24292F">();</span></li><li value="11"><span style="color: #24292F">  })</span></li><li value="12"><span style="color: #24292F">.</span><span style="color: #8250DF">case</span><span style="color: #24292F">(Bob, (() </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> ({</span></li><li value="13"><span style="color: #24292F">  when: </span><span style="color: #8250DF">declassify</span><span style="color: #24292F">(interact.</span><span style="color: #8250DF">keepGoing</span><span style="color: #24292F">()) })),</span></li><li value="14"><span style="color: #24292F">  ((</span><span style="color: #953800">_</span><span style="color: #24292F">) </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> wager),</span></li><li value="15"><span style="color: #24292F">  (</span><span style="color: #953800">_</span><span style="color: #24292F">) </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> {</span></li><li value="16"><span style="color: #24292F">    </span><span style="color: #8250DF">commit</span><span style="color: #24292F">();</span></li><li value="17"></li><li value="18"><span style="color: #24292F">    Alice.</span><span style="color: #8250DF">only</span><span style="color: #24292F">(() </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> interact.</span><span style="color: #8250DF">showOpponent</span><span style="color: #24292F">(Bob));</span></li><li value="19"></li><li value="20"><span style="color: #24292F">    </span><span style="color: #8250DF">race</span><span style="color: #24292F">(Alice, Bob).</span><span style="color: #8250DF">publish</span><span style="color: #24292F">();</span></li><li value="21"><span style="color: #24292F">    </span><span style="color: #8250DF">transfer</span><span style="color: #24292F">(</span><span style="color: #0550AE">2</span><span style="color: #24292F"> </span><span style="color: #CF222E">*</span><span style="color: #24292F"> wager).</span><span style="color: #8250DF">to</span><span style="color: #24292F">(</span><span style="color: #0550AE">this</span><span style="color: #24292F">);</span></li><li value="22"><span style="color: #24292F">    </span><span style="color: #8250DF">commit</span><span style="color: #24292F">();</span></li><li value="23"><span style="color: #24292F">    </span><span style="color: #8250DF">exit</span><span style="color: #24292F">();</span></li><li value="24"><span style="color: #24292F">  })</span></li><li value="25"><span style="color: #24292F">.</span><span style="color: #8250DF">timeout</span><span style="color: #24292F">(deadline, () </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> {</span></li><li value="26"><span style="color: #24292F">  </span><span style="color: #8250DF">race</span><span style="color: #24292F">(Alice, Bob).</span><span style="color: #8250DF">publish</span><span style="color: #24292F">();</span></li><li value="27"><span style="color: #24292F">  </span><span style="color: #8250DF">transfer</span><span style="color: #24292F">(wager).</span><span style="color: #8250DF">to</span><span style="color: #24292F">(</span><span style="color: #0550AE">this</span><span style="color: #24292F">);</span></li><li value="28"><span style="color: #24292F">  </span><span style="color: #8250DF">commit</span><span style="color: #24292F">();</span></li><li value="29"><span style="color: #24292F">  </span><span style="color: #8250DF">exit</span><span style="color: #24292F">(); });</span></li></ol></pre>
<p>A fork statement is an abbreviation of a common race and switch pattern you could write yourself. The idea is that each of the participants in the case components do an independent local step evaluation of a value they would like to publish and then all race to publish their value. The one that "wins" the race then determines not only the value (&amp; pay expression), but also what consensus step code runs to consume the value. The example above is roughly equivalent to the following:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #6E7781">// We first define a Data instance so that each participant can publish a different kind of value.</span></li><li value="2"><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">ForkData</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #8250DF">Data</span><span style="color: #24292F">({ Alice: UInt, Bob: Null });</span></li><li value="3"></li><li value="4"><span style="color: #6E7781">// Then we bind these values for each participant</span></li><li value="5"><span style="color: #24292F">Alice.</span><span style="color: #8250DF">only</span><span style="color: #24292F">(() </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> {</span></li><li value="6"><span style="color: #24292F">  </span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">fork_msg</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> ForkData.</span><span style="color: #8250DF">Alice</span><span style="color: #24292F">(</span><span style="color: #0550AE">19</span><span style="color: #24292F">);</span></li><li value="7"><span style="color: #24292F">  </span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">fork_when</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #8250DF">declassify</span><span style="color: #24292F">(interact.</span><span style="color: #8250DF">keepGoing</span><span style="color: #24292F">());</span></li><li value="8"><span style="color: #24292F">});</span></li><li value="9"><span style="color: #24292F">Bob.</span><span style="color: #8250DF">only</span><span style="color: #24292F">(() </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> {</span></li><li value="10"><span style="color: #24292F">  </span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">fork_msg</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> ForkData.</span><span style="color: #8250DF">Bob</span><span style="color: #24292F">(</span><span style="color: #0550AE">null</span><span style="color: #24292F">);</span></li><li value="11"><span style="color: #24292F">  </span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">fork_when</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #8250DF">declassify</span><span style="color: #24292F">(interact.</span><span style="color: #8250DF">keepGoing</span><span style="color: #24292F">());</span></li><li value="12"><span style="color: #24292F">});</span></li><li value="13"></li><li value="14"><span style="color: #6E7781">// They race</span></li><li value="15"><span style="color: #8250DF">race</span><span style="color: #24292F">(Alice, Bob)</span></li><li value="16"><span style="color: #24292F">  .</span><span style="color: #8250DF">publish</span><span style="color: #24292F">(fork_msg)</span></li><li value="17"><span style="color: #24292F">  .</span><span style="color: #8250DF">when</span><span style="color: #24292F">(fork_when)</span></li><li value="18"></li><li value="19"><span style="color: #24292F">  </span><span style="color: #6E7781">// The pay ammount depends on who is publishing</span></li><li value="20"><span style="color: #24292F">  .</span><span style="color: #8250DF">pay</span><span style="color: #24292F">(fork_msg.</span><span style="color: #8250DF">match</span><span style="color: #24292F">({</span></li><li value="21"><span style="color: #24292F">    Alice: (</span><span style="color: #953800">v</span><span style="color: #24292F"> </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> v),</span></li><li value="22"><span style="color: #24292F">    Bob: ((</span><span style="color: #953800">_</span><span style="color: #24292F">) </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> wager)</span></li><li value="23"><span style="color: #24292F">  }))</span></li><li value="24"></li><li value="25"><span style="color: #24292F">  </span><span style="color: #6E7781">// The timeout is always the same</span></li><li value="26"><span style="color: #24292F">  .</span><span style="color: #8250DF">timeout</span><span style="color: #24292F">(deadline, () </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> {</span></li><li value="27"><span style="color: #24292F">    </span><span style="color: #8250DF">race</span><span style="color: #24292F">(Alice, Bob).</span><span style="color: #8250DF">publish</span><span style="color: #24292F">();</span></li><li value="28"><span style="color: #24292F">    </span><span style="color: #8250DF">transfer</span><span style="color: #24292F">(wager).</span><span style="color: #8250DF">to</span><span style="color: #24292F">(</span><span style="color: #0550AE">this</span><span style="color: #24292F">);</span></li><li value="29"><span style="color: #24292F">    </span><span style="color: #8250DF">commit</span><span style="color: #24292F">();</span></li><li value="30"><span style="color: #24292F">    </span><span style="color: #8250DF">exit</span><span style="color: #24292F">();</span></li><li value="31"><span style="color: #24292F">  });</span></li><li value="32"></li><li value="33"><span style="color: #6E7781">// We ensure that the correct participant published the correct kind of value</span></li><li value="34"><span style="color: #0550AE">require</span><span style="color: #24292F">(fork_msg.</span><span style="color: #8250DF">match</span><span style="color: #24292F">({</span></li><li value="35"></li><li value="36"><span style="color: #24292F">  </span><span style="color: #6E7781">// Alice had previously published</span></li><li value="37"><span style="color: #24292F">  Alice: (</span><span style="color: #953800">v</span><span style="color: #24292F"> </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> </span><span style="color: #0550AE">this</span><span style="color: #24292F"> </span><span style="color: #CF222E">==</span><span style="color: #24292F"> Alice),</span></li><li value="38"></li><li value="39"><span style="color: #24292F">  </span><span style="color: #6E7781">// But Bob had not.</span></li><li value="40"><span style="color: #24292F">  Bob: ((</span><span style="color: #953800">_</span><span style="color: #24292F">) </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> </span><span style="color: #0550AE">true</span><span style="color: #24292F">)</span></li><li value="41"><span style="color: #24292F">}));</span></li><li value="42"></li><li value="43"><span style="color: #6E7781">// Then we select the appropriate body to run</span></li><li value="44"><span style="color: #CF222E">switch</span><span style="color: #24292F"> (fork_msg) {</span></li><li value="45"><span style="color: #24292F">  </span><span style="color: #CF222E">case</span><span style="color: #24292F"> Alice: {</span></li><li value="46"><span style="color: #24292F">    </span><span style="color: #8250DF">assert</span><span style="color: #24292F">(</span><span style="color: #0550AE">this</span><span style="color: #24292F"> </span><span style="color: #CF222E">==</span><span style="color: #24292F"> Alice);</span></li><li value="47"><span style="color: #24292F">    </span><span style="color: #0550AE">require</span><span style="color: #24292F">(v </span><span style="color: #CF222E">==</span><span style="color: #24292F"> </span><span style="color: #0550AE">19</span><span style="color: #24292F">);</span></li><li value="48"><span style="color: #24292F">    </span><span style="color: #8250DF">transfer</span><span style="color: #24292F">(wager </span><span style="color: #CF222E">+</span><span style="color: #24292F"> </span><span style="color: #0550AE">19</span><span style="color: #24292F">).</span><span style="color: #8250DF">to</span><span style="color: #24292F">(</span><span style="color: #0550AE">this</span><span style="color: #24292F">);</span></li><li value="49"><span style="color: #24292F">    </span><span style="color: #8250DF">commit</span><span style="color: #24292F">();</span></li><li value="50"><span style="color: #24292F">    </span><span style="color: #8250DF">exit</span><span style="color: #24292F">();</span></li><li value="51"><span style="color: #24292F">  }</span></li><li value="52"><span style="color: #24292F">  </span><span style="color: #CF222E">case</span><span style="color: #24292F"> Bob: {</span></li><li value="53"><span style="color: #24292F">    Bob.</span><span style="color: #8250DF">set</span><span style="color: #24292F">(</span><span style="color: #0550AE">this</span><span style="color: #24292F">);</span></li><li value="54"><span style="color: #24292F">    </span><span style="color: #8250DF">commit</span><span style="color: #24292F">();</span></li><li value="55"></li><li value="56"><span style="color: #24292F">    Alice.</span><span style="color: #8250DF">only</span><span style="color: #24292F">(() </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> interact.</span><span style="color: #8250DF">showOpponent</span><span style="color: #24292F">(Bob));</span></li><li value="57"></li><li value="58"><span style="color: #24292F">    </span><span style="color: #8250DF">race</span><span style="color: #24292F">(Alice, Bob).</span><span style="color: #8250DF">publish</span><span style="color: #24292F">();</span></li><li value="59"><span style="color: #24292F">    </span><span style="color: #8250DF">transfer</span><span style="color: #24292F">(</span><span style="color: #0550AE">2</span><span style="color: #24292F"> </span><span style="color: #CF222E">*</span><span style="color: #24292F"> wager).</span><span style="color: #8250DF">to</span><span style="color: #24292F">(</span><span style="color: #0550AE">this</span><span style="color: #24292F">);</span></li><li value="60"><span style="color: #24292F">    </span><span style="color: #8250DF">commit</span><span style="color: #24292F">();</span></li><li value="61"><span style="color: #24292F">    </span><span style="color: #8250DF">exit</span><span style="color: #24292F">();</span></li><li value="62"><span style="color: #24292F">  }</span></li><li value="63"><span style="color: #24292F">}</span></li></ol></pre>
<p>This pattern is tedious to write and error-prone, so the fork statement abbreviates it for Reach programmers. When a participant specifies multiple cases, the msg field of the participant will be wrapped with an additional variant signifying what case was chosen.</p>
<h1 id="function">function<a aria-hidden="true" tabindex="-1" href="#function"><span class="icon icon-link"></span></a></h1>
<p><code>function</code> is an <em>identifier definition</em> that binds an identifier to a <em>function</em> definition. Here is an example:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #CF222E">function</span><span style="color: #24292F"> </span><span style="color: #8250DF">randomBool</span><span style="color: #24292F">() { </span><span style="color: #CF222E">return</span><span style="color: #24292F"> (interact.</span><span style="color: #8250DF">random</span><span style="color: #24292F">() </span><span style="color: #CF222E">%</span><span style="color: #24292F"> </span><span style="color: #0550AE">2</span><span style="color: #24292F">) </span><span style="color: #CF222E">==</span><span style="color: #24292F"> </span><span style="color: #0550AE">0</span><span style="color: #24292F">; };</span></li></ol></pre>
<p>Function parameters may specify default arguments, but they must appear last:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #CF222E">function</span><span style="color: #24292F"> </span><span style="color: #8250DF">f</span><span style="color: #24292F">(</span><span style="color: #953800">a</span><span style="color: #24292F">, </span><span style="color: #953800">b</span><span style="color: #24292F">, </span><span style="color: #953800">c</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> a </span><span style="color: #CF222E">+</span><span style="color: #24292F"> </span><span style="color: #0550AE">1</span><span style="color: #24292F">, </span><span style="color: #953800">d</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> b </span><span style="color: #CF222E">+</span><span style="color: #24292F"> c) </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> </span><span style="color: #953800">a</span><span style="color: #24292F"> + </span><span style="color: #953800">b</span><span style="color: #24292F"> + </span><span style="color: #953800">c</span><span style="color: #24292F"> + </span><span style="color: #953800">d</span><span style="color: #24292F">;</span></li></ol></pre>
<p>Argument expressions like <code>d = b + c</code> have access to preceding arguments (e.g. <code>c</code>) and to any variables within the scope in which the function itself was defined.</p>
<p>The last parameter of a function may be a <em>rest</em> parameter (e.g. <code>...nums</code>) which allows the function to be called with an arbitrary number of arguments:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #CF222E">function</span><span style="color: #24292F"> </span><span style="color: #8250DF">sum</span><span style="color: #24292F">(</span><span style="color: #953800">x</span><span style="color: #24292F">, </span><span style="color: #CF222E">...</span><span style="color: #953800">nums</span><span style="color: #24292F">) {</span></li><li value="2"><span style="color: #24292F">  </span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">arr</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #8250DF">array</span><span style="color: #24292F">(UInt, nums);</span></li><li value="3"><span style="color: #24292F">  </span><span style="color: #CF222E">return</span><span style="color: #24292F"> x </span><span style="color: #CF222E">+</span><span style="color: #24292F"> arr.</span><span style="color: #8250DF">reduce</span><span style="color: #24292F">(</span><span style="color: #0550AE">0</span><span style="color: #24292F">, add);</span></li><li value="4"><span style="color: #24292F">}</span></li></ol></pre>
<p>You might invoke the <code>sum</code> function like this:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #0550AE">A</span><span style="color: #24292F">.interact.</span><span style="color: #8250DF">report</span><span style="color: #24292F">(</span><span style="color: #8250DF">sum</span><span style="color: #24292F">(</span><span style="color: #0550AE">2</span><span style="color: #24292F">, </span><span style="color: #0550AE">4</span><span style="color: #24292F">, </span><span style="color: #0550AE">6</span><span style="color: #24292F">, </span><span style="color: #0550AE">8</span><span style="color: #24292F">));</span></li></ol></pre>
<p>You cannot re-bind a previously bound identifier to a new function definition. For more, see <a href="#const">const</a>.</p>
<h1 id="if-else">if else<a aria-hidden="true" tabindex="-1" href="#if-else"><span class="icon icon-link"></span></a></h1>
<p>Reach supports conditional statements. Here is an example:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #CF222E">if</span><span style="color: #24292F"> (</span><span style="color: #CF222E">!</span><span style="color: #24292F">willBuy) {</span></li><li value="2"><span style="color: #24292F">  </span><span style="color: #8250DF">commit</span><span style="color: #24292F">();</span></li><li value="3"><span style="color: #24292F">  </span><span style="color: #8250DF">each</span><span style="color: #24292F">([</span><span style="color: #0550AE">S</span><span style="color: #24292F">, </span><span style="color: #0550AE">B</span><span style="color: #24292F">], () </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> interact.</span><span style="color: #8250DF">reportCancellation</span><span style="color: #24292F">());</span></li><li value="4"><span style="color: #24292F">  </span><span style="color: #8250DF">exit</span><span style="color: #24292F">();</span></li><li value="5"><span style="color: #24292F">} </span><span style="color: #CF222E">else</span><span style="color: #24292F"> {</span></li><li value="6"><span style="color: #24292F">  </span><span style="color: #8250DF">commit</span><span style="color: #24292F">();</span></li><li value="7"><span style="color: #24292F">}</span></li></ol></pre>
<p>If one branch of a conditional contains <code>commit</code> or <code>return</code>, then the other must, too.</p>
<p>Identifiers bound within the scopes of the <code>if</code> or <code>else</code> sets of curly braces are not bound outside the scopes:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #CF222E">if</span><span style="color: #24292F"> ( x </span><span style="color: #CF222E">&lt;</span><span style="color: #24292F"> y ) {</span></li><li value="2"><span style="color: #24292F">  </span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">z</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #0550AE">3</span><span style="color: #24292F">;</span></li><li value="3"><span style="color: #24292F">}</span></li><li value="4"><span style="color: #CF222E">else</span><span style="color: #24292F"> {</span></li><li value="5"><span style="color: #24292F">  </span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">z</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #0550AE">4</span><span style="color: #24292F">;</span></li><li value="6"><span style="color: #24292F">}</span></li><li value="7"><span style="color: #CF222E">return</span><span style="color: #24292F"> z; </span><span style="color: #6E7781">// Invalid</span></li></ol></pre>
<p>A conditional statement may include a consensus transfer only when the statement occurs within a consensus step.</p>
<h1 id="import">import<a aria-hidden="true" tabindex="-1" href="#import"><span class="icon icon-link"></span></a></h1>
<h1 id="only">only<a aria-hidden="true" tabindex="-1" href="#only"><span class="icon icon-link"></span></a></h1>
<p><code>each</code> and <code>only</code> statements transition from <em>step</em> mode to <em>local step</em> mode and then back to <em>step</em> mode. In other words, local steps occur within the body of <code>each</code> and <code>only</code> statements. Here is the declaration:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #8250DF">each</span><span style="color: #24292F">(</span><span style="color: #8250DF">PART_TUPLE</span><span style="color: #24292F"> () </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> </span><span style="color: #0550AE">BLOCK</span><span style="color: #24292F">)</span></li><li value="2"><span style="color: #6E7781">// and</span></li><li value="3"><span style="color: #0550AE">PART</span><span style="color: #24292F">.</span><span style="color: #8250DF">only</span><span style="color: #24292F">(() </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> </span><span style="color: #0550AE">BLOCK</span><span style="color: #24292F">)</span></li></ol></pre>
<ul>
  <li><code>PART_TUPLE</code> is a tuple of participants (e.g. <code>[Alice, Bob]</code>).</li>
  <li><code>PART</code> is a participant.</li>
  <li><code>BLOCK</code> stands for one or more local statements.</li>
</ul>
<p>Here is an example:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #24292F">Alice.</span><span style="color: #8250DF">only</span><span style="color: #24292F">(() </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> { </span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">x</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #0550AE">3</span><span style="color: #24292F">; });</span></li><li value="2"><span style="color: #6E7781">// and </span></li><li value="3"><span style="color: #8250DF">each</span><span style="color: #24292F">([Alice, Bob], () </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> { </span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">pretzel</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> interact.</span><span style="color: #8250DF">random</span><span style="color: #24292F">(); });</span></li></ol></pre>
<p>A local step statement is written PART.only(() =&gt; BLOCK), where PART is a participant identifier and BLOCK is a block. Within BLOCK, PART is bound to the address of the participant. Any bindings defined within the block of a local step are available in the statement’s tail as new local state. For example,</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #24292F">Alice.</span><span style="color: #8250DF">only</span><span style="color: #24292F">(() </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> { </span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">x</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #0550AE">3</span><span style="color: #24292F">; });</span></li><li value="2"><span style="color: #24292F">Alice.</span><span style="color: #8250DF">only</span><span style="color: #24292F">(() </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> { </span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">y</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> x </span><span style="color: #CF222E">+</span><span style="color: #24292F"> </span><span style="color: #0550AE">1</span><span style="color: #24292F">; });</span></li></ol></pre>
<p>is a valid program where Alice’s local state includes the private values x (bound to 3) and y (bound to 4). However, such bindings are not consensus state, so they are purely local state. For example,</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #24292F">Alice.</span><span style="color: #8250DF">only</span><span style="color: #24292F">(() </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> { </span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">x</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #0550AE">3</span><span style="color: #24292F">; });</span></li><li value="2"><span style="color: #24292F">Bob.</span><span style="color: #8250DF">only</span><span style="color: #24292F">(() </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> { </span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">y</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> x </span><span style="color: #CF222E">+</span><span style="color: #24292F"> </span><span style="color: #0550AE">1</span><span style="color: #24292F">; });</span></li></ol></pre>
<p>is an invalid program, because Bob does not know x.</p>
<p>The interact shorthand, written PART.interact.METHOD(EXPR_0, ..., EXPR_n), is available for calling an interact function from outside of an only block. Such functions must return Null; therefore, they are only useful if they produce side-effects, such as logging on the frontend. For example, the function log in the participant interact interface of Alice may be called via:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #24292F">Alice.interact.</span><span style="color: #8250DF">log</span><span style="color: #24292F">(x);</span></li></ol></pre>
<p>An each local step statement can be written as each(PART_TUPLE () =&gt; BLOCK), where PART_TUPLE is a tuple of participants and BLOCK is a block. It is an abbreviation of many local step statements that could have been written with only.</p>
<h1 id="parallelreduce">parallelReduce<a aria-hidden="true" tabindex="-1" href="#parallelreduce"><span class="icon icon-link"></span></a></h1>
<h1 id="pay">pay<a aria-hidden="true" tabindex="-1" href="#pay"><span class="icon icon-link"></span></a></h1>
<p>See <a href="#publish">publish</a>.</p>
<h1 id="publish">publish<a aria-hidden="true" tabindex="-1" href="#publish"><span class="icon icon-link"></span></a></h1>
<p>A consensus transfer often involves one or more of the following expressions: <code>publish</code>, <code>pay</code>, <code>when</code>, and <code>timeout</code>. Here is the declaration:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #0550AE">PART_EXPR</span><span style="color: #24292F">.</span><span style="color: #8250DF">publish</span><span style="color: #24292F">(</span><span style="color: #0550AE">ID_0</span><span style="color: #24292F">, </span><span style="color: #CF222E">...</span><span style="color: #24292F">, ID_n)</span></li><li value="2"><span style="color: #24292F">  .</span><span style="color: #8250DF">pay</span><span style="color: #24292F">(</span><span style="color: #0550AE">PAY_EXPR</span><span style="color: #24292F">)</span></li><li value="3"><span style="color: #24292F">  .</span><span style="color: #8250DF">when</span><span style="color: #24292F">(</span><span style="color: #0550AE">WHEN_EXPR</span><span style="color: #24292F">)</span></li><li value="4"><span style="color: #24292F">  .</span><span style="color: #8250DF">timeout</span><span style="color: #24292F">(</span><span style="color: #0550AE">DELAY_EXPR</span><span style="color: #24292F">, () </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> </span><span style="color: #0550AE">TIMEOUT_BLOCK</span><span style="color: #24292F">)</span></li><li value="5"><span style="color: #24292F">  </span><span style="color: #6E7781">// or</span></li><li value="6"><span style="color: #24292F">  .</span><span style="color: #8250DF">throwTimeout</span><span style="color: #24292F">(</span><span style="color: #0550AE">DELAY_EXPR</span><span style="color: #24292F">, </span><span style="color: #0550AE">THROWN_EXPR</span><span style="color: #24292F">)</span></li></ol></pre>
<ul>
  <li><code>PART_EXPR</code> is an expression that evaluates to a participant or race expression.</li>
  <li><code>ID_0</code> through <code>ID_n</code> are identifiers for the participants’s public local state.</li>
  <li><code>PAY_EXPR</code> is a public expression evaluating to a <a href="/en/books/essentials/terminology/#pay-amount">pay amount</a>.</li>
  <li><code>WHEN_EXPR</code> is a public expression evaluating to a boolean and determines if the consensus transfer takes place.</li>
  <li><code>DELAY_EXPR</code> is a public expression that depends on only consensus state and evaluates to a time argument.</li>
  <li><code>TIMEOUT_BLOCK</code> is a timeout block, which will be executed after the delay.</li>
  <li><code>DELAY_EXPR</code> time argument passes without the participant executing this consensus transfer.</li>
</ul>
<p>Here are examples:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #24292F">Alice.</span><span style="color: #8250DF">publish</span><span style="color: #24292F">(wagerAmount)</span></li><li value="2"><span style="color: #24292F">  .</span><span style="color: #8250DF">pay</span><span style="color: #24292F">(wagerAmount)</span></li><li value="3"><span style="color: #24292F">  .</span><span style="color: #8250DF">timeout</span><span style="color: #24292F">(</span><span style="color: #0550AE">DELAY</span><span style="color: #24292F">, () </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> {</span></li><li value="4"><span style="color: #24292F">    Bob.</span><span style="color: #8250DF">publish</span><span style="color: #24292F">();</span></li><li value="5"><span style="color: #24292F">    </span><span style="color: #8250DF">commit</span><span style="color: #24292F">();</span></li><li value="6"><span style="color: #24292F">    </span><span style="color: #CF222E">return</span><span style="color: #24292F"> </span><span style="color: #0550AE">false</span><span style="color: #24292F">; </span></li><li value="7"><span style="color: #24292F">  }); </span></li><li value="8"></li><li value="9"><span style="color: #24292F">Alice.</span><span style="color: #8250DF">publish</span><span style="color: #24292F">(wagerAmount)</span></li><li value="10"><span style="color: #24292F">  .</span><span style="color: #8250DF">pay</span><span style="color: #24292F">(wagerAmount)</span></li><li value="11"><span style="color: #24292F">  .</span><span style="color: #8250DF">timeout</span><span style="color: #24292F">(</span><span style="color: #0550AE">DELAY</span><span style="color: #24292F">, () </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> </span><span style="color: #8250DF">closeTo</span><span style="color: #24292F">(Bob, </span><span style="color: #0550AE">false</span><span style="color: #24292F">)); </span></li><li value="12"></li><li value="13"><span style="color: #24292F">Alice.</span><span style="color: #8250DF">publish</span><span style="color: #24292F">(wagerAmount)</span></li><li value="14"><span style="color: #24292F">  .</span><span style="color: #8250DF">pay</span><span style="color: #24292F">(wagerAmount)</span></li><li value="15"><span style="color: #24292F">  .</span><span style="color: #8250DF">timeout</span><span style="color: #24292F">(</span><span style="color: #0550AE">false</span><span style="color: #24292F">);</span></li></ol></pre>
<p>All of the expressions within a consensus transfer are evaluated in a pure context, which may not alter the state of the application. The PAY_EXPR, WHEN_EXPR, and DELAY_EXPR expressions must refer only to the consensus state, including the new data published via the .publish component.</p>
<p>The continuation of a consensus transfer statement is a consensus step, which is finalized with a commit statement. The continuation of a timeout block is the same as the continuation of the function the timeout occurs within.</p>
<p>See the guide section on non-participation to understand when to use timeouts and how to use them most effectively.</p>
<p>The publish component exclusive-or the pay component may be omitted, if either there is no publication or no transfer of network tokens to accompany this consensus transfer. The when component may always be omitted, in which case it is assumed to be true. publish or pay must occur first, after which components may occur in any order. For example, the following are all valid:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #24292F">Alice.</span><span style="color: #8250DF">publish</span><span style="color: #24292F">(coinFlip);</span></li><li value="2"></li><li value="3"><span style="color: #24292F">Alice.</span><span style="color: #8250DF">pay</span><span style="color: #24292F">(penaltyAmount);</span></li><li value="4"></li><li value="5"><span style="color: #24292F">Alice.</span><span style="color: #8250DF">pay</span><span style="color: #24292F">(penaltyAmount).</span><span style="color: #8250DF">publish</span><span style="color: #24292F">(coinFlip);</span></li><li value="6"></li><li value="7"><span style="color: #24292F">Alice.</span><span style="color: #8250DF">publish</span><span style="color: #24292F">(coinFlip)</span></li><li value="8"><span style="color: #24292F">  .</span><span style="color: #8250DF">timeout</span><span style="color: #24292F">(</span><span style="color: #0550AE">DELAY</span><span style="color: #24292F">, () </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> </span><span style="color: #8250DF">closeTo</span><span style="color: #24292F">(Bob, () </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> </span><span style="color: #8250DF">exit</span><span style="color: #24292F">()));</span></li><li value="9"></li><li value="10"><span style="color: #24292F">Alice.</span><span style="color: #8250DF">pay</span><span style="color: #24292F">(penaltyAmount)</span></li><li value="11"><span style="color: #24292F">  .</span><span style="color: #8250DF">timeout</span><span style="color: #24292F">(</span><span style="color: #0550AE">DELAY</span><span style="color: #24292F">, () </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> {</span></li><li value="12"><span style="color: #24292F">    Bob.</span><span style="color: #8250DF">publish</span><span style="color: #24292F">();</span></li><li value="13"><span style="color: #24292F">    </span><span style="color: #8250DF">commit</span><span style="color: #24292F">();</span></li><li value="14"><span style="color: #24292F">    </span><span style="color: #8250DF">exit</span><span style="color: #24292F">(); </span></li><li value="15"><span style="color: #24292F">  });</span></li><li value="16"></li><li value="17"><span style="color: #24292F">Alice.</span><span style="color: #8250DF">publish</span><span style="color: #24292F">(bid).</span><span style="color: #8250DF">when</span><span style="color: #24292F">(wantsToBid);</span></li></ol></pre>
<p>The timeout component must be included if when is not statically true. This ensures that your clients will eventually complete the program. If a consensus transfer is a guaranteed race between non-class participants and a participant class that may attempt to transfer (i.e. when is not statically false), then a timeout may be explicitly omitted by writing .timeout(false).</p>
<p>.throwTimeout may be used in place of .timeout. It accepts a DELAY_EXPR and an EXPR, which will be thrown if a timeout should occur. If an EXPR is not provided, then null will be thrown. If a consensus transfer uses .throwTimeout, it must be within a try statement.</p>
<p>If a consensus transfer specifies a single participant, which has not yet been fixed in the application and is not a participant class, then this statement does so; therefore, after it the PART may be used as an address.</p>
<p>If a consensus transfer specificies a single participant class, then all members of that class will attempt to perform the transfer, but only one will succeed.</p>
<p>A consensus transfer binds the identifiers ID_0 through ID_n for all participants to the values included in the consensus transfer, overwriting any bindings that already exist for those identifiers. If an existing participant, not included in PART_EXPR, has previously bound one of these identifiers, then the program is not valid. In other words, the following program is not valid:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #24292F">Alice.</span><span style="color: #8250DF">only</span><span style="color: #24292F">(() </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> {</span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">x</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #0550AE">1</span><span style="color: #24292F">; });</span></li><li value="2"><span style="color: #24292F">Bob.</span><span style="color: #8250DF">only</span><span style="color: #24292F">(() </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> {</span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">x</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #0550AE">2</span><span style="color: #24292F">; });</span></li><li value="3"><span style="color: #24292F">Claire.</span><span style="color: #8250DF">only</span><span style="color: #24292F">(() </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> {</span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">x</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #0550AE">3</span><span style="color: #24292F">; });</span></li><li value="4"><span style="color: #8250DF">race</span><span style="color: #24292F">(Alice, Bob).</span><span style="color: #8250DF">publish</span><span style="color: #24292F">(x);</span></li><li value="5"><span style="color: #8250DF">commit</span><span style="color: #24292F">();</span></li></ol></pre>
<p>because Claire is not included in the race. However, if we were to rename Claire’s x into y, then it would be valid, because although Alice and Bob both bind x, they participate in the race, so it is allowed. In the tail of this program, x is bound to either 1 or 2, i.e., either Alice or Bob’s value is overwritten. This overwriting applies even if Alice wins and Alice is a participant class, i.e., the value of x in the tail is guaranteed to be the single value that was agreed upon in the consensus.</p>
<h1 id="return">return<a aria-hidden="true" tabindex="-1" href="#return"><span class="icon icon-link"></span></a></h1>
<p>Reach supports the <code>return</code> statement which returns a value to the surrounding scope:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #CF222E">function</span><span style="color: #24292F"> </span><span style="color: #8250DF">whoWinsBestOfThree</span><span style="color: #24292F">(</span><span style="color: #953800">winCountA</span><span style="color: #24292F">, </span><span style="color: #953800">winCountB</span><span style="color: #24292F">, </span><span style="color: #953800">lastOutcome</span><span style="color: #24292F">) {</span></li><li value="2"><span style="color: #24292F">  </span><span style="color: #CF222E">if</span><span style="color: #24292F"> (winCountA </span><span style="color: #CF222E">&gt;</span><span style="color: #24292F"> winCountB) { </span><span style="color: #CF222E">return</span><span style="color: #24292F"> </span><span style="color: #0550AE">A_WINS</span><span style="color: #24292F">; } </span></li><li value="3"><span style="color: #24292F">  </span><span style="color: #CF222E">else</span><span style="color: #24292F"> </span><span style="color: #CF222E">if</span><span style="color: #24292F"> (winCountB </span><span style="color: #CF222E">&gt;</span><span style="color: #24292F"> winCountA) { </span><span style="color: #CF222E">return</span><span style="color: #24292F"> </span><span style="color: #0550AE">B_WINS</span><span style="color: #24292F">; } </span></li><li value="4"><span style="color: #24292F">  </span><span style="color: #CF222E">else</span><span style="color: #24292F"> </span><span style="color: #CF222E">if</span><span style="color: #24292F"> (lastOutcome </span><span style="color: #CF222E">==</span><span style="color: #24292F"> </span><span style="color: #0550AE">B_QUITS</span><span style="color: #24292F">) { </span><span style="color: #CF222E">return</span><span style="color: #24292F"> </span><span style="color: #0550AE">B_QUITS</span><span style="color: #24292F">; } </span></li><li value="5"><span style="color: #24292F">  </span><span style="color: #CF222E">else</span><span style="color: #24292F"> </span><span style="color: #CF222E">if</span><span style="color: #24292F"> (lastOutcome </span><span style="color: #CF222E">==</span><span style="color: #24292F"> </span><span style="color: #0550AE">A_QUITS</span><span style="color: #24292F">) { </span><span style="color: #CF222E">return</span><span style="color: #24292F"> </span><span style="color: #0550AE">A_QUITS</span><span style="color: #24292F">; } </span></li><li value="6"><span style="color: #24292F">  </span><span style="color: #CF222E">else</span><span style="color: #24292F"> { </span><span style="color: #CF222E">return</span><span style="color: #24292F"> </span><span style="color: #0550AE">A_WINS</span><span style="color: #24292F">; }</span></li><li value="7"><span style="color: #24292F">}</span></li></ol></pre>
<p>A <code>return</code> statement is a terminator statement, so it must be the last statement in the scope:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #CF222E">function</span><span style="color: #24292F"> </span><span style="color: #8250DF">whoWinsBestOfThree</span><span style="color: #24292F">(</span><span style="color: #953800">winCountA</span><span style="color: #24292F">, </span><span style="color: #953800">winCountB</span><span style="color: #24292F">, </span><span style="color: #953800">lastOutcome</span><span style="color: #24292F">) {</span></li><li value="2"><span style="color: #24292F">  </span><span style="color: #CF222E">return</span><span style="color: #24292F"> </span><span style="color: #0550AE">3</span><span style="color: #24292F">;</span></li><li value="3"><span style="color: #24292F">  </span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">x</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #0550AE">5</span><span style="color: #24292F">; </span><span style="color: #6E7781">// Invalid</span></li><li value="4"><span style="color: #24292F">}</span></li></ol></pre>
<h1 id="setoptions">setOptions<a aria-hidden="true" tabindex="-1" href="#setoptions"><span class="icon icon-link"></span></a></h1>
<p>The <code>setOptions</code> statement overrides default application parameters.</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #8250DF">setOptions</span><span style="color: #24292F">({ verifyArithmetic: </span><span style="color: #0550AE">true</span><span style="color: #24292F">, connectors: [</span><span style="color: #0550AE">ETH</span><span style="color: #24292F">, </span><span style="color: #0550AE">ALGO</span><span style="color: #24292F"> ] });</span></li></ol></pre>
<p>The options object may include the following:</p>
<table>
  <thead>
    <tr>
      <th>Option</th>
      <th>Type</th>
      <th>Default</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>connectors</code></td>
      <td><code>Array</code></td>
      <td>All available connectors</td>
    </tr>
    <tr>
      <td><code>verifyArithmetic</code></td>
      <td><code>Boolean</code></td>
      <td><code>false</code></td>
    </tr>
    <tr>
      <td><code>verifyPerConnector</code></td>
      <td><code>Boolean</code></td>
      <td><code>false</code></td>
    </tr>
  </tbody>
</table>
<p><code>connectors</code> is an array of tuples indicating for which consensus networks the compiler will generate contract bytecode.</p>
<p><code>verifyArithmetic</code> is a boolean value indicating whether arithmetic operations introduce static assertions that they do not overflow beyond <code>UInt.max</code>. This defaults to false because it is onerous to verify. We recommend turning it on before final deployment, but leaving it off during development. When it is false, connectors will ensure that overflows do not actually occur on the network.</p>
<p><code>verifyPerConnector</code> is a boolean value that determines whether verification is done per connector, or once for a generic connector. When this is true, then connector-specific constants, like UInt.max, will be instantiated to literal numbers. This concretization of these constants can induce performance degradation in the verifier.</p>
<h1 id="switch">switch<a aria-hidden="true" tabindex="-1" href="#switch"><span class="icon icon-link"></span></a></h1>
<p>Reach supports the <code>switch</code> statement which selects one of many code blocks based on a given expression:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #CF222E">switch</span><span style="color: #24292F"> (x) {</span></li><li value="2"><span style="color: #24292F">  </span><span style="color: #CF222E">case</span><span style="color: #24292F"> </span><span style="color: #0550AE">0</span><span style="color: #24292F">: </span><span style="color: #CF222E">return</span><span style="color: #24292F"> </span><span style="color: #0550AE">0</span><span style="color: #24292F">;</span></li><li value="3"><span style="color: #24292F">  </span><span style="color: #CF222E">case</span><span style="color: #24292F"> </span><span style="color: #0550AE">1</span><span style="color: #24292F">: </span><span style="color: #CF222E">return</span><span style="color: #24292F"> </span><span style="color: #0550AE">1</span><span style="color: #24292F">;</span></li><li value="4"><span style="color: #24292F">  </span><span style="color: #CF222E">default</span><span style="color: #24292F">: </span><span style="color: #CF222E">return</span><span style="color: #24292F"> </span><span style="color: #8250DF">fib</span><span style="color: #24292F">(x </span><span style="color: #CF222E">-</span><span style="color: #24292F"> </span><span style="color: #0550AE">1</span><span style="color: #24292F">) </span><span style="color: #CF222E">+</span><span style="color: #24292F"> </span><span style="color: #8250DF">fib</span><span style="color: #24292F">(x </span><span style="color: #CF222E">-</span><span style="color: #24292F"> </span><span style="color: #0550AE">2</span><span style="color: #24292F">);</span></li><li value="5"><span style="color: #24292F">}</span></li></ol></pre>
<p>Note the following:</p>
<ul>
  <li>If one case of a <code>switch</code> contains a <code>return</code> statement, then all must.</li>
  <li>A <code>case</code> must appear only once.</li>
  <li>A <code>case</code> must be the same type as the evaluated expression.</li>
  <li><code>switch</code> statements do not support <code>break</code> statements because a previous <code>case</code> does not fall through to the next.</li>
</ul>
<h1 id="try-catch-throw">try catch throw<a aria-hidden="true" tabindex="-1" href="#try-catch-throw"><span class="icon icon-link"></span></a></h1>
<h1 id="var">var<a aria-hidden="true" tabindex="-1" href="#var"><span class="icon icon-link"></span></a></h1>
<p>Reach supports <code>var</code> only immediately before a while loop and its invariant:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #0A3069">'reach 0.1'</span><span style="color: #24292F">;</span></li><li value="2"></li><li value="3"><span style="color: #CF222E">export</span><span style="color: #24292F"> </span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">main</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> Reach.</span><span style="color: #8250DF">App</span><span style="color: #24292F">(</span></li><li value="4"><span style="color: #24292F">  {}, [</span><span style="color: #8250DF">Participant</span><span style="color: #24292F">(</span><span style="color: #0A3069">'A'</span><span style="color: #24292F">, {})], (</span><span style="color: #953800">A</span><span style="color: #24292F">) </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> {</span></li><li value="5"><span style="color: #24292F">    </span><span style="color: #0550AE">A</span><span style="color: #24292F">.</span><span style="color: #8250DF">publish</span><span style="color: #24292F">();</span></li><li value="6"><span style="color: #24292F">    </span><span style="color: #CF222E">var</span><span style="color: #24292F"> [x] </span><span style="color: #CF222E">=</span><span style="color: #24292F"> [</span><span style="color: #0550AE">1</span><span style="color: #24292F">];</span></li><li value="7"><span style="color: #24292F">    </span><span style="color: #8250DF">invariant</span><span style="color: #24292F">(</span><span style="color: #0550AE">true</span><span style="color: #24292F">);</span></li><li value="8"><span style="color: #24292F">    </span><span style="color: #CF222E">while</span><span style="color: #24292F">(x </span><span style="color: #CF222E">&lt;</span><span style="color: #24292F"> </span><span style="color: #0550AE">2</span><span style="color: #24292F">) {</span></li><li value="9"><span style="color: #24292F">      [ x, y ] </span><span style="color: #CF222E">=</span><span style="color: #24292F"> [ x </span><span style="color: #CF222E">+</span><span style="color: #24292F"> </span><span style="color: #0550AE">1</span><span style="color: #24292F">, x ];</span></li><li value="10"><span style="color: #24292F">      </span><span style="color: #CF222E">continue</span><span style="color: #24292F">;</span></li><li value="11"><span style="color: #24292F">    }</span></li><li value="12"><span style="color: #24292F">    </span><span style="color: #8250DF">commit</span><span style="color: #24292F">();</span></li><li value="13"><span style="color: #24292F">  }</span></li><li value="14"><span style="color: #24292F">);</span></li></ol></pre>
<h1 id="wait">wait<a aria-hidden="true" tabindex="-1" href="#wait"><span class="icon icon-link"></span></a></h1>
<p>A <code>wait</code> statement delays computation for a duration specified in terms of seconds or in terms of increments specific to the consensus network. Here is the declaration:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #8250DF">wait</span><span style="color: #24292F">(</span><span style="color: #0550AE">TIME</span><span style="color: #24292F">)</span></li></ol></pre>
<p>See <a href="/en/essentials/terminology/#time-argument">Time Argument</a>.</p>
<h1 id="while">while<a aria-hidden="true" tabindex="-1" href="#while"><span class="icon icon-link"></span></a></h1>
<p>A <code>while</code> statement loops until the specified condition is <code>false</code>. Here is the declaration:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #CF222E">var</span><span style="color: #24292F"> </span><span style="color: #0550AE">LHS</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> </span><span style="color: #0550AE">INIT_EXPR</span><span style="color: #24292F">;</span></li><li value="2"><span style="color: #0550AE">DEFINE_BLOCK</span><span style="color: #24292F">; </span><span style="color: #6E7781">// optional</span></li><li value="3"><span style="color: #8250DF">invariant</span><span style="color: #24292F">(</span><span style="color: #0550AE">INVARIANT_EXPR</span><span style="color: #24292F">);</span></li><li value="4"><span style="color: #CF222E">while</span><span style="color: #24292F">( </span><span style="color: #0550AE">COND_EXPR</span><span style="color: #24292F"> ) </span><span style="color: #0550AE">BLOCK</span></li></ol></pre>
<ul>
  <li><code>LHS</code> is a valid left-hand side of an identifier definition where the expression INIT_EXPR is the right-hand side.</li>
  <li><code>DEFINE_BLOCK</code> is an optional block that may define bindings that use the LHS values which are bound inside the rest of the while and its tail.</li>
  <li><code>INVARIANT_EXPR</code> is an expression, called the loop invariant, that must be true before and after every execution of the block BLOCK</li>
  <li><code>COND_EXPR</code> is the condition. While it is true the block executes. When it is false the loop terminates and control transfers to the continuation of the while statement. The identifiers bound by <code>LHS</code> are bound within <code>DEFINE_BLOCK</code>, <code>INVARIANT_EXPR</code>, <code>COND_EXPR</code>, <code>BLOCK</code>, and the tail of the while statement.</li>
</ul>
<p>Here is an example:</p>
<pre class="snippet unnumbered"><ol class="snippet"><li value="1"><span style="color: #CF222E">var</span><span style="color: #24292F"> [ heap1, heap2 ] </span><span style="color: #CF222E">=</span><span style="color: #24292F"> [ </span><span style="color: #0550AE">21</span><span style="color: #24292F">, </span><span style="color: #0550AE">21</span><span style="color: #24292F"> ];</span></li><li value="2"><span style="color: #24292F">{ </span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #8250DF">sum</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> () </span><span style="color: #CF222E">=&gt;</span><span style="color: #24292F"> heap1 </span><span style="color: #CF222E">+</span><span style="color: #24292F"> heap2; }</span></li><li value="3"><span style="color: #8250DF">invariant</span><span style="color: #24292F">(</span><span style="color: #8250DF">balance</span><span style="color: #24292F">() </span><span style="color: #CF222E">==</span><span style="color: #24292F"> </span><span style="color: #0550AE">2</span><span style="color: #24292F"> </span><span style="color: #CF222E">*</span><span style="color: #24292F"> wagerAmount);</span></li><li value="4"><span style="color: #CF222E">while</span><span style="color: #24292F"> ( </span><span style="color: #8250DF">sum</span><span style="color: #24292F">() </span><span style="color: #CF222E">&gt;</span><span style="color: #24292F"> </span><span style="color: #0550AE">0</span><span style="color: #24292F"> ) {</span></li><li value="5"><span style="color: #24292F">  </span><span style="color: #CF222E">...</span><span style="color: #24292F">.</span></li><li value="6"><span style="color: #24292F">  [ heap1, heap2 ] </span><span style="color: #CF222E">=</span><span style="color: #24292F"> [ heap1 </span><span style="color: #CF222E">-</span><span style="color: #24292F"> </span><span style="color: #0550AE">1</span><span style="color: #24292F">, heap2 ];</span></li><li value="7"><span style="color: #24292F">  </span><span style="color: #CF222E">continue</span><span style="color: #24292F">; }</span></li></ol></pre>