<p>
  <i id="p_0" class="pid"></i><a href="https://www.trufflesuite.com/ganache">Ganache</a> is a very popular Ethereum personal blockchain for quick application development, deployment, and testing with a replica of the Ethereum mainnet.
  Ganache provides many customization options, such as control over the gas limit and price.<a href="#p_0" class="pid">0</a>
</p>
<p><i id="p_1" class="pid"></i>There are two ways to use Ganache with Reach.<a href="#p_1" class="pid">1</a></p>
<p>
  <i id="p_2" class="pid"></i>First, you can run the Ganache desktop application and start a workspace, then connect to it using the Reach <code>ETH-live</code> connector mode.
  This requires specifying the node URI as well.
  For example, if you're running your Reach frontend from within Docker, and Ganache on your host machine, you might run:<a href="#p_2" class="pid">2</a>
</p>
<pre class="snippet unnumbered"><div class="codeHeader">&nbsp;<a class="far fa-copy copyBtn" data-clipboard-text="$ REACH_CONNECTOR_MODE=ETH-live ETH_NODE_URI=http://host.docker.internal:7545 REACH_ISOLATED_NETWORK=1 reach run" href="#"></a></div><ol class="snippet"><li value="1">$ REACH_CONNECTOR_MODE=ETH-live ETH_NODE_URI=http://host.docker.internal:7545 REACH_ISOLATED_NETWORK=1 reach run</li></ol></pre>
<p><i id="p_3" class="pid"></i>This sets the Ethereum URI to the host machine's port and instructs Reach that the network is "isolated", which means it is for testing.<a href="#p_3" class="pid">3</a></p>
<p>
  <i id="p_4" class="pid"></i>Second, you can programmatically create a Ganache network from inside of your JavaScript frontend and set it is as a provider for the Reach standard library.
  This requires some modification to your frontend.<a href="#p_4" class="pid">4</a>
</p>
<p>
  <i id="p_5" class="pid"></i>You need to add the <code>ganache-core</code> package as a dependency in your <code>package.json</code> file.
  If you don't already have one, then you'll want to use <code>reach scaffold</code> to set one up.
  You'll also need to add the <code>ethers</code> package, because you'll be directly interacting with the underlying network to set things up.<a href="#p_5" class="pid">5</a>
</p>
<p><i id="p_6" class="pid"></i>After that, you need to import the two packages on the JavaScript side in your <code>index.mjs</code> file:<a href="#p_6" class="pid">6</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/ganache/index.mjs">/examples/ganache/index.mjs</a><a class="far fa-copy copyBtn" data-clipboard-text="import {loadStdlib} from '@reach-sh/stdlib';
import * as backend from './build/index.main.mjs';
import ethers from 'ethers';
import ganache from 'ganache-core';

(async () => {
  const stdlib = loadStdlib(process.env);
  if ( stdlib.connector !== 'ETH' ) { return; }

  const ganacheOptions = {};
  const ganacheProvider =
    new ethers.providers.Web3Provider(
      ganache.provider(ganacheOptions));
  stdlib.setProvider(ganacheProvider);

  const faucet = ganacheProvider.getSigner();
  stdlib.setFaucet(stdlib.connectAccount(faucet));

  const startingBalance = stdlib.parseCurrency(50);
  const accAlice = await stdlib.newTestAccount(startingBalance)

  const ctcAlice = accAlice.deploy(backend);
  await Promise.all([
    backend.Alice(ctcAlice, {
      ...stdlib.hasRandom,
    }),
  ]);
})();" href="#"></a></div><ol class="snippet"><li value="3"><span style="color: #CF222E">import</span><span style="color: #24292F"> ethers </span><span style="color: #CF222E">from</span><span style="color: #24292F"> </span><span style="color: #0A3069">'ethers'</span><span style="color: #24292F">;</span></li><li value="4"><span style="color: #CF222E">import</span><span style="color: #24292F"> ganache </span><span style="color: #CF222E">from</span><span style="color: #24292F"> </span><span style="color: #0A3069">'ganache-core'</span><span style="color: #24292F">;</span></li></ol></pre>
<p><i id="p_7" class="pid"></i>Next, you need to actually create the Ganache-based provider and connect it to Reach:<a href="#p_7" class="pid">7</a></p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/ganache/index.mjs">/examples/ganache/index.mjs</a><a class="far fa-copy copyBtn" data-clipboard-text="import {loadStdlib} from '@reach-sh/stdlib';
import * as backend from './build/index.main.mjs';
import ethers from 'ethers';
import ganache from 'ganache-core';

(async () => {
  const stdlib = loadStdlib(process.env);
  if ( stdlib.connector !== 'ETH' ) { return; }

  const ganacheOptions = {};
  const ganacheProvider =
    new ethers.providers.Web3Provider(
      ganache.provider(ganacheOptions));
  stdlib.setProvider(ganacheProvider);

  const faucet = ganacheProvider.getSigner();
  stdlib.setFaucet(stdlib.connectAccount(faucet));

  const startingBalance = stdlib.parseCurrency(50);
  const accAlice = await stdlib.newTestAccount(startingBalance)

  const ctcAlice = accAlice.deploy(backend);
  await Promise.all([
    backend.Alice(ctcAlice, {
      ...stdlib.hasRandom,
    }),
  ]);
})();" href="#"></a></div><ol class="snippet"><li value="9"></li><li value="10"><span style="color: #24292F">  </span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">ganacheOptions</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> {};</span></li><li value="11"><span style="color: #24292F">  </span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">ganacheProvider</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span></li><li value="12"><span style="color: #24292F">    </span><span style="color: #CF222E">new</span><span style="color: #24292F"> ethers.providers.</span><span style="color: #8250DF">Web3Provider</span><span style="color: #24292F">(</span></li><li value="13"><span style="color: #24292F">      ganache.</span><span style="color: #8250DF">provider</span><span style="color: #24292F">(ganacheOptions));</span></li></ol></pre>
<p>
  <i id="p_8" class="pid"></i>This will work, but Reach will not consider the network to be "isolated", which means that it won't be able to fund test accounts.
  You can enable this by setting the Reach faucet:<a href="#p_8" class="pid">8</a>
</p>
<pre class="snippet numbered"><div class="codeHeader"><a href="https://github.com/reach-sh/reach-lang/tree/master/examples/ganache/index.mjs">/examples/ganache/index.mjs</a><a class="far fa-copy copyBtn" data-clipboard-text="import {loadStdlib} from '@reach-sh/stdlib';
import * as backend from './build/index.main.mjs';
import ethers from 'ethers';
import ganache from 'ganache-core';

(async () => {
  const stdlib = loadStdlib(process.env);
  if ( stdlib.connector !== 'ETH' ) { return; }

  const ganacheOptions = {};
  const ganacheProvider =
    new ethers.providers.Web3Provider(
      ganache.provider(ganacheOptions));
  stdlib.setProvider(ganacheProvider);

  const faucet = ganacheProvider.getSigner();
  stdlib.setFaucet(stdlib.connectAccount(faucet));

  const startingBalance = stdlib.parseCurrency(50);
  const accAlice = await stdlib.newTestAccount(startingBalance)

  const ctcAlice = accAlice.deploy(backend);
  await Promise.all([
    backend.Alice(ctcAlice, {
      ...stdlib.hasRandom,
    }),
  ]);
})();" href="#"></a></div><ol class="snippet"><li value="15"></li><li value="16"><span style="color: #24292F">  </span><span style="color: #CF222E">const</span><span style="color: #24292F"> </span><span style="color: #0550AE">faucet</span><span style="color: #24292F"> </span><span style="color: #CF222E">=</span><span style="color: #24292F"> ganacheProvider.</span><span style="color: #8250DF">getSigner</span><span style="color: #24292F">();</span></li></ol></pre>
<p><i id="p_9" class="pid"></i>If you want to use some of the interesting customizations that Ganache provides, then refer to <a href="https://github.com/trufflesuite/ganache/tree/master#options">their documentation</a> about what <span class="snip"><span style="color: #24292F">ganacheOptions</span></span> may be set to.<a href="#p_9" class="pid">9</a></p>