<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-149147406-2"></script><script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-149147406-2');</script><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js"></script><script src="tooltips.js"></script><script src="reach-pre.js"></script><link rel="stylesheet" href="tooltips.css"><link rel="stylesheet" href="reach.css"><link rel="stylesheet" href="minted.css"><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png"><link rel="manifest" href="/favicon/site.webmanifest"><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>4.4&nbsp;Workshop: Fear of Missing Out</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Reach:<span class="mywbr"> &nbsp;</span> The Safest and Easiest DApp Programming Language</a></td></tr></table></div><div class="tocviewsublisttop" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="overview.html" class="tocviewlink" data-pltdoc="x">Overview</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="tut.html" class="tocviewlink" data-pltdoc="x">Tutorial</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="guide.html" class="tocviewlink" data-pltdoc="x">Guide</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="workshop.html" class="tocviewselflink" data-pltdoc="x">Workshop</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="ref.html" class="tocviewlink" data-pltdoc="x">Reference</a></td></tr><tr><td align="right"></td><td><a href="doc-index.html" class="tocviewlink" data-pltdoc="x">Index</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9660;</a></td><td>4&nbsp;</td><td><a href="workshop.html" class="tocviewlink" data-pltdoc="x">Workshop</a></td></tr></table><div class="tocviewsublist" style="display: block;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">4.1&nbsp;</td><td><a href="workshop-hash-lock.html" class="tocviewlink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> Hash Lock</a></td></tr><tr><td align="right">4.2&nbsp;</td><td><a href="workshop-relay.html" class="tocviewlink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> Relay Account</a></td></tr><tr><td align="right">4.3&nbsp;</td><td><a href="workshop-trust-fund.html" class="tocviewlink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> Trust Fund</a></td></tr><tr><td align="right">4.4&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> Fear of Missing Out</a></td></tr><tr><td align="right">4.5&nbsp;</td><td><a href="workshop-fomo-generalized.html" class="tocviewlink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> Fear of Missing Out Generalized</a></td></tr><tr><td align="right">4.6&nbsp;</td><td><a href="workshop-rps-fair.html" class="tocviewlink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> Fair Rock-<wbr></wbr>Paper-<wbr></wbr>Scissors</a></td></tr><tr><td align="right">4.7&nbsp;</td><td><a href="workshop-rps-eff.html" class="tocviewlink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> Efficient Rock-<wbr></wbr>Paper-<wbr></wbr>Scissors</a></td></tr><tr><td align="right">4.8&nbsp;</td><td><a href="workshop-rental.html" class="tocviewlink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> Rental Agreement</a></td></tr><tr><td align="right">4.9&nbsp;</td><td><a href="workshop-abstract-simul.html" class="tocviewlink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> Simultaneous Games</a></td></tr><tr><td align="right">4.10&nbsp;</td><td><a href="workshop-guardian-account.html" class="tocviewlink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> Guardian Account</a></td></tr><tr><td align="right">4.11&nbsp;</td><td><a href="workshop-utility.html" class="tocviewlink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> Periodic Payment</a></td></tr><tr><td align="right">4.12&nbsp;</td><td><a href="workshop-nim.html" class="tocviewlink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> Nim</a></td></tr><tr><td align="right">4.13&nbsp;</td><td><a href="workshop-ttt.html" class="tocviewlink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> Tic-<wbr></wbr>Tac-<wbr></wbr>Toe</a></td></tr><tr><td align="right">4.14&nbsp;</td><td><a href="workshop-secured-loan.html" class="tocviewlink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> Secured Loan</a></td></tr><tr><td align="right">4.15&nbsp;</td><td><a href="workshop-atomic-swap.html" class="tocviewlink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> Atomic Swap</a></td></tr><tr><td align="right">4.16&nbsp;</td><td><a href="workshop-atomic-swap-auction.html" class="tocviewlink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> Atomic Swap Auction</a></td></tr><tr><td align="right">4.17&nbsp;</td><td><a href="workshop-race.html" class="tocviewlink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> Race</a></td></tr><tr><td align="right">4.18&nbsp;</td><td><a href="workshop-chicken-race.html" class="tocviewlink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> Chicken</a></td></tr><tr><td align="right">4.19&nbsp;</td><td><a href="workshop-popularity-contest.html" class="tocviewlink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> Popularity Contest</a></td></tr><tr><td align="right">4.20&nbsp;</td><td><a href="workshop-nft-dumb.html" class="tocviewlink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> Simple NFT</a></td></tr><tr><td align="right">4.21&nbsp;</td><td><a href="workshop-nft-auction.html" class="tocviewlink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> NFT with Auction</a></td></tr><tr><td align="right">4.22&nbsp;</td><td><a href="workshop-nft-tax.html" class="tocviewlink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> NFT with Royalties and Harberger Tax</a></td></tr><tr><td align="right">4.23&nbsp;</td><td><a href="workshop-raffle.html" class="tocviewlink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> Raffle</a></td></tr><tr><td align="right">4.24&nbsp;</td><td><a href="workshop-rent-seeking.html" class="tocviewlink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> Rent Seeking</a></td></tr><tr><td align="right">4.25&nbsp;</td><td><a href="workshop-remote.html" class="tocviewlink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> Remote Objects</a></td></tr><tr><td align="right">4.26&nbsp;</td><td><a href="workshop-oracle.html" class="tocviewlink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> Oracle</a></td></tr><tr><td align="right">4.27&nbsp;</td><td><a href="workshop-auction-te.html" class="tocviewlink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> Timed English Auction</a></td></tr><tr><td align="right">4.28&nbsp;</td><td><a href="workshop-crowdfund.html" class="tocviewlink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> Crowd-<wbr></wbr>funding</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_2&quot;);">&#9658;</a></td><td>4.4&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Workshop:<span class="mywbr"> &nbsp;</span> Fear of Missing Out</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_2"><table cellspacing="0" cellpadding="0"><tr><td align="right">4.4.1&nbsp;</td><td><a href="#%28part._workshop-fomo-pr%29" class="tocviewlink" data-pltdoc="x">Problem Analysis</a></td></tr><tr><td align="right">4.4.2&nbsp;</td><td><a href="#%28part._workshop-fomo-dd%29" class="tocviewlink" data-pltdoc="x">Data Definition</a></td></tr><tr><td align="right">4.4.3&nbsp;</td><td><a href="#%28part._workshop-fomo-cc%29" class="tocviewlink" data-pltdoc="x">Communication Construction</a></td></tr><tr><td align="right">4.4.4&nbsp;</td><td><a href="#%28part._workshop-fomo-ai%29" class="tocviewlink" data-pltdoc="x">Assertion Insertion</a></td></tr><tr><td align="right">4.4.5&nbsp;</td><td><a href="#%28part._workshop-fomo-ii%29" class="tocviewlink" data-pltdoc="x">Interaction Introduction</a></td></tr><tr><td align="right">4.4.6&nbsp;</td><td><a href="#%28part._workshop-fomo-de%29" class="tocviewlink" data-pltdoc="x">Deployment Decisions</a></td></tr><tr><td align="right">4.4.7&nbsp;</td><td><a href="#%28part._workshop-fomo-dns%29" class="tocviewlink" data-pltdoc="x">Discussion and Next Steps</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">4.4.1<tt>&nbsp;</tt></span><a href="#%28part._workshop-fomo-pr%29" class="tocsubseclink" data-pltdoc="x">Problem Analysis</a></td></tr><tr><td><span class="tocsublinknumber">4.4.2<tt>&nbsp;</tt></span><a href="#%28part._workshop-fomo-dd%29" class="tocsubseclink" data-pltdoc="x">Data Definition</a></td></tr><tr><td><span class="tocsublinknumber">4.4.3<tt>&nbsp;</tt></span><a href="#%28part._workshop-fomo-cc%29" class="tocsubseclink" data-pltdoc="x">Communication Construction</a></td></tr><tr><td><span class="tocsublinknumber">4.4.4<tt>&nbsp;</tt></span><a href="#%28part._workshop-fomo-ai%29" class="tocsubseclink" data-pltdoc="x">Assertion Insertion</a></td></tr><tr><td><span class="tocsublinknumber">4.4.5<tt>&nbsp;</tt></span><a href="#%28part._workshop-fomo-ii%29" class="tocsubseclink" data-pltdoc="x">Interaction Introduction</a></td></tr><tr><td><span class="tocsublinknumber">4.4.6<tt>&nbsp;</tt></span><a href="#%28part._workshop-fomo-de%29" class="tocsubseclink" data-pltdoc="x">Deployment Decisions</a></td></tr><tr><td><span class="tocsublinknumber">4.4.7<tt>&nbsp;</tt></span><a href="#%28part._workshop-fomo-dns%29" class="tocsubseclink" data-pltdoc="x">Discussion and Next Steps</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="version">0.1.7</span></div><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search docs..." title="Enter a search string to search the Reach documentation" onkeypress="return reach_DoSearch(event, this);"></form>&nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="workshop-trust-fund.html" title="backward to &quot;4.3 Workshop: Trust Fund&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="workshop.html" title="up to &quot;4 Workshop&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="workshop-fomo-generalized.html" title="forward to &quot;4.5 Workshop: Fear of Missing Out Generalized&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h4>4.4<tt>&nbsp;</tt><a name="(part._workshop-fomo)"></a>Workshop: Fear of Missing Out</h4><div class="SAuthorListBox"><span class="SAuthorList"><p class="author">Chris Nevers &lt;<a href="mailto:cnevers@reach.sh">cnevers@reach.sh</a>&gt;</p></span></div><p>In this workshop, we&rsquo;ll design an application that allows a Funder
to create an auction where participants may purchase tickets.
The Funder sets a ticket price and a relative deadline. When
a Buyer purchases a ticket, the deadline is reset. Whoever is the
last person to buy a ticket&#8212;when the deadline finally hits&#8212;wins
the entire balance. This program is based off of the crypto game,
<a href="https://fomo3d.hostedwiki.co/">FOMO3DGame</a>.</p><p>This workshop utilizes <a href="ref-model.html#%28tech._participant._clas%29" class="techoutside" data-pltdoc="x"><span class="techinside">participant class</span></a>es to represent Buyers, which allows us to handle multiple participants in a generic way.</p><p><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>This workshop is independent of all others.</p></blockquote></blockquote></blockquote></div><div class="SIntrapara">We assume that you&rsquo;ll go through this workshop in a directory named <span class="stt">~/reach/workshop-fomo</span>:
</div><div class="SIntrapara"><span class="hspace">&nbsp;&nbsp;</span><span style="font-weight: bold"><span class="stt">$</span></span><span class="stt"> </span><span class="stt">mkdir -p ~/reach/</span><span class="stt">workshop-fomo</span><span class="stt"> &amp;&amp; cd ~/reach/</span><span class="stt">workshop-fomo</span></div></p><p><div class="SIntrapara">And that you have a copy of Reach <a href="ref-install.html" data-pltdoc="x">installed</a> in <span class="stt">~/reach</span> so you can write
</div><div class="SIntrapara"><span class="hspace">&nbsp;&nbsp;</span><span style="font-weight: bold"><span class="stt">$</span></span><span class="stt"> </span><span class="stt">../reach version</span></div></p><p>And it will run Reach.</p><p><div class="SIntrapara">You should start off by initializing your Reach program:
</div><div class="SIntrapara"><span class="hspace">&nbsp;&nbsp;</span><span style="font-weight: bold"><span class="stt">$</span></span><span class="stt"> </span><span class="stt">../reach init</span></div></p><h5>4.4.1<tt>&nbsp;</tt><a name="(part._workshop-fomo-pr)"></a>Problem Analysis</h5><p>First, we should think over the details of the application and
answer some questions to help reason about the implementation of
the program.</p><p>You should write the answer to the following questions in your
Reach program (<span class="stt">index.rsh</span>) using a comment.
<code class="highlight"><span class="cm">/* Remember comments are written like this. */</span></code></p><ul><li><p>Who is involved in this application?</p></li><li><p>What information do they know at the start of the program?</p></li><li><p>What information are they going to discover and use
in the program?</p></li><li><p>What funds change ownership during the application and how?</p></li></ul><blockquote class="SCentered"><p><br/><br/><br/><span style="font-weight: bold">Stop!</span><br/>Write down the problem analysis of this program as a comment.<br/><br/><br/><br/></p></blockquote><p>Let&rsquo;s see how your answers compare to ours:</p><ul><li><p>This program involves two parties: a Funder who deploys the
auction and the Buyers who purchase tickets.</p></li><li><p>The Funder knows the deadline and the ticket price at the
start of the application.</p></li><li><p>The Buyers do not know anything of the deadline or ticket price when the application begins.</p></li><li><p>The Funder does not learn anything during the program execution.</p></li><li><p>The Buyers learn of the ticket price and deadline during the
program execution.</p></li><li><p>Buyers continually add funds to the balance during execution until one Buyer wins the entire balance.</p></li></ul><p>It&rsquo;s okay if some of your answers differ from ours!</p><h5>4.4.2<tt>&nbsp;</tt><a name="(part._workshop-fomo-dd)"></a>Data Definition</h5><p><div class="SIntrapara">After problem analysis, we need to decide how we will represent the information
in the program:
</div><div class="SIntrapara"><ul><li><p>What data type will represent the deadline set by the Funder?</p></li><li><p>What data type will represent the ticket price set by the Funder?</p></li><li><p>What data type will represent the Buyer&rsquo;s decision to purchase a ticket?</p></li></ul></div><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>Refer to <a href="ref-programs-compute.html#%28part._ref-programs-types%29" data-pltdoc="x">Types</a> for a reminder of what data types are available in Reach.</p></blockquote></blockquote></blockquote></div></p><p>Now that we&rsquo;ve decided what data types to use, we need to determine how the programs will obtain this information. We need to outline the <a href="ref-programs-appinit.html#%28tech._participant._interact._interface%29" class="techoutside" data-pltdoc="x"><span class="techinside">participant interact interface</span></a> for each participant.</p><ul><li><p>What <a href="ref-programs-appinit.html#%28tech._participant._interact._interface%29" class="techoutside" data-pltdoc="x"><span class="techinside">participant interact interface</span></a> will Funder use?</p></li><li><p>What <a href="ref-programs-appinit.html#%28tech._participant._interact._interface%29" class="techoutside" data-pltdoc="x"><span class="techinside">participant interact interface</span></a> will Buyer use?</p></li></ul><p>Revisit the problem analysis section when completing this section. Whenever
a participant starts off with some knowledge, that will be a field in the
<code class="highlight"><a href="ref-programs-local.html#%28reach._%28%28interact%29%29%29" class="k" data-pltdoc="x">interact</a></code> object.
If they learn something, then it will be an argument to a function.
If they provide something later, then it will be the result of a function.</p><p>You should write your answers in your Reach file (<span class="stt">index.rsh</span>) as the <a href="ref-programs-appinit.html#%28tech._participant._interact._interface%29" class="techoutside" data-pltdoc="x"><span class="techinside">participant interact interface</span></a> for each of the participants.</p><blockquote class="SCentered"><p><br/><br/><br/><span style="font-weight: bold">Stop!</span><br/>Write down the data definitions for this program as definitions.<br/><br/><br/><br/></p></blockquote><p>Let&rsquo;s compare your answers with ours:</p><ul><li><p>The deadline will be represented with a <code class="highlight"><a href="ref-programs-compute.html#%28reach._%28%28.U.Int%29%29%29" class="nb" data-pltdoc="x">UInt</a></code>, as it is
a relative time delta signifying a change in block numbers.</p></li><li><p>The <span class="stt">ticketPrice</span> will be represented with a <code class="highlight"><a href="ref-programs-compute.html#%28reach._%28%28.U.Int%29%29%29" class="nb" data-pltdoc="x">UInt</a></code></p></li><li><p>The decision to buy a ticket will be represented by a function <code class="highlight"><a href="ref-programs-compute.html#%28reach._%28%28.Fun%29%29%29" class="nb" data-pltdoc="x">Fun</a><span class="p">([</span><a href="ref-programs-compute.html#%28reach._%28%28.U.Int%29%29%29" class="nb" data-pltdoc="x">UInt</a><span class="p">],</span> <a href="ref-programs-compute.html#%28reach._%28%28.Bool%29%29%29" class="nb" data-pltdoc="x">Bool</a><span class="p">)</span></code></p></li></ul><p>Our <a href="ref-programs-appinit.html#%28tech._participant._interact._interface%29" class="techoutside" data-pltdoc="x"><span class="techinside">participant interact interface</span></a>, with the addition of some handy logging functions, looks like this so far:</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/workshop-fomo/index.rsh#L4-L22"><span class="stt">workshop-fomo/index.rsh</span></a><button class="btn" data-clipboard-text="const CommonInterface = {
  // Show the address of winner
  showOutcome: Fun([Address], Null),
};

const FunderInterface = {
  ...CommonInterface,
  getParams: Fun([], Object({
    // relative deadline
    deadline: UInt,
    ticketPrice: UInt,
  })),
};

const BuyerInterface = {
  ...CommonInterface,
  shouldBuyTicket: Fun([UInt], Bool),
  showPurchase: Fun([Address], Null),
};"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span><span class="p">..</span>    <span class="c1">// ...</span>
 <span class="mi">4</span>    <a href="ref-programs-compute.html#%28reach._%28%28const%29%29%29" class="kd" data-pltdoc="x">const</a> <font class="badlink"><span class="nx">CommonInterface</span></font> <font class="badlink"><span class="o">=</span></font> <span class="p">{</span>
 <span class="mi">5</span>    <span class="c1">// Show the address of winner</span>
 <span class="mi">6</span>    <font class="badlink"><span class="nx">showOutcome</span></font><font class="badlink"><span class="o">:</span></font> <a href="ref-programs-compute.html#%28reach._%28%28.Fun%29%29%29" class="nb" data-pltdoc="x">Fun</a><span class="p">([</span><a href="ref-programs-compute.html#%28reach._%28%28.Address%29%29%29" class="nb" data-pltdoc="x">Address</a><span class="p">],</span> <a href="ref-programs-compute.html#%28reach._%28%28.Null%29%29%29" class="nb" data-pltdoc="x">Null</a><span class="p">),</span>
 <span class="mi">7</span>    <span class="p">};</span>
 <span class="mi">8</span>    
 <span class="mi">9</span>    <a href="ref-programs-compute.html#%28reach._%28%28const%29%29%29" class="kd" data-pltdoc="x">const</a> <font class="badlink"><span class="nx">FunderInterface</span></font> <font class="badlink"><span class="o">=</span></font> <span class="p">{</span>
<span class="mi">10</span>    <span class="p">...</span><font class="badlink"><span class="nx">CommonInterface</span></font><span class="p">,</span>
<span class="mi">11</span>    <font class="badlink"><span class="nx">getParams</span></font><font class="badlink"><span class="o">:</span></font> <a href="ref-programs-compute.html#%28reach._%28%28.Fun%29%29%29" class="nb" data-pltdoc="x">Fun</a><span class="p">([],</span> <a href="ref-programs-compute.html#%28reach._%28%28.Object%29%29%29" class="nb" data-pltdoc="x">Object</a><span class="p">({</span>
<span class="mi">12</span>      <span class="c1">// relative deadline</span>
<span class="mi">13</span>      <font class="badlink"><span class="nx">deadline</span></font><font class="badlink"><span class="o">:</span></font> <a href="ref-programs-compute.html#%28reach._%28%28.U.Int%29%29%29" class="nb" data-pltdoc="x">UInt</a><span class="p">,</span>
<span class="mi">14</span>      <font class="badlink"><span class="nx">ticketPrice</span></font><font class="badlink"><span class="o">:</span></font> <a href="ref-programs-compute.html#%28reach._%28%28.U.Int%29%29%29" class="nb" data-pltdoc="x">UInt</a><span class="p">,</span>
<span class="mi">15</span>    <span class="p">})),</span>
<span class="mi">16</span>    <span class="p">};</span>
<span class="mi">17</span>    
<span class="mi">18</span>    <a href="ref-programs-compute.html#%28reach._%28%28const%29%29%29" class="kd" data-pltdoc="x">const</a> <font class="badlink"><span class="nx">BuyerInterface</span></font> <font class="badlink"><span class="o">=</span></font> <span class="p">{</span>
<span class="mi">19</span>    <span class="p">...</span><font class="badlink"><span class="nx">CommonInterface</span></font><span class="p">,</span>
<span class="mi">20</span>    <font class="badlink"><span class="nx">shouldBuyTicket</span></font><font class="badlink"><span class="o">:</span></font> <a href="ref-programs-compute.html#%28reach._%28%28.Fun%29%29%29" class="nb" data-pltdoc="x">Fun</a><span class="p">([</span><a href="ref-programs-compute.html#%28reach._%28%28.U.Int%29%29%29" class="nb" data-pltdoc="x">UInt</a><span class="p">],</span> <a href="ref-programs-compute.html#%28reach._%28%28.Bool%29%29%29" class="nb" data-pltdoc="x">Bool</a><span class="p">),</span>
<span class="mi">21</span>    <font class="badlink"><span class="nx">showPurchase</span></font><font class="badlink"><span class="o">:</span></font> <a href="ref-programs-compute.html#%28reach._%28%28.Fun%29%29%29" class="nb" data-pltdoc="x">Fun</a><span class="p">([</span><a href="ref-programs-compute.html#%28reach._%28%28.Address%29%29%29" class="nb" data-pltdoc="x">Address</a><span class="p">],</span> <a href="ref-programs-compute.html#%28reach._%28%28.Null%29%29%29" class="nb" data-pltdoc="x">Null</a><span class="p">),</span>
<span class="mi">22</span>    <span class="p">};</span>
<span class="p">..</span>    <span class="c1">// ...</span>
</pre></div></div></p><p>At this point, you can modify your JavaScript file (<span class="stt">index.mjs</span>) to contain definitions of these values, although you may want to use placeholders for the actual values.
When you&rsquo;re writing a Reach program, especially in the early phases, you should have these two files open side-by-side and update them in tandem as you&rsquo;re deciding the <a href="ref-programs-appinit.html#%28tech._participant._interact._interface%29" class="techoutside" data-pltdoc="x"><span class="techinside">participant interact interface</span></a>.</p><h5>4.4.3<tt>&nbsp;</tt><a name="(part._workshop-fomo-cc)"></a>Communication Construction</h5><p>A fundamental aspect of a decentralized application is the pattern of communication
and transfer among the participants. We should write down this structure as comments
in our program to serve as an outline and guide us in implementation.
For example, for the <a href="tut.html" data-pltdoc="x">tutorial</a> version of <span class="emph">Rock, Paper, Scissors!</span>, we might write:
<div class="highlight"><pre><span></span><span class="c1">// Alice publishes the wager and pays it</span>
<span class="c1">// Bob accepts the wager and pays it</span>
<span class="c1">// While there&#39;s a draw</span>
<span class="c1">//  Alice publishes her hand secretly</span>
<span class="c1">//  Bob publishes his hand publicly</span>
<span class="c1">//  Alice reveals her hand</span>
<span class="c1">//  The consensus ensures it&#39;s the same hand as before</span>
<span class="c1">// The consensus pays out the wager</span>
</pre></div></p><p>You should do this now, in your Reach program (<span class="stt">index.rsh</span>).</p><blockquote class="SCentered"><p><br/><br/><br/><span style="font-weight: bold">Stop!</span><br/>Write down the communication pattern for this program as comments.<br/><br/><br/><br/></p></blockquote><p>Here&rsquo;s what we wrote for our outline:
<div class="highlight"><pre><span></span><span class="c1">// 1. The Funder publishes the ticket price and deadline</span>
<span class="c1">// 2. While the deadline has yet to be reached:</span>
<span class="c1">//     2a. Allow a Buyer to purchase a ticket</span>
<span class="c1">//     2b. Keep track of last Buyer</span>
<span class="c1">// 3. Transfer the balance to the last person who bought a ticket</span>
</pre></div></p><p>Now, this outline needs to be converted to a real program.</p><blockquote class="SCentered"><p><br/><br/><br/><span style="font-weight: bold">Stop!</span><br/>Write down the communication pattern for this program as code.<br/><br/><br/><br/></p></blockquote><p>The body of your application should look something like this:</p><p><div class="highlight"><pre><span></span><span class="c1">// 1. The Funder publishes the ticket price and deadline</span>
<font class="badlink"><span class="nx">Funder</span></font><span class="p">.</span><a href="ref-programs-step.html#%28reach._%28%28publish%29%29%29" class="k" data-pltdoc="x">publish</a><span class="p">(</span><font class="badlink"><span class="nx">ticketPrice</span></font><span class="p">,</span> <font class="badlink"><span class="nx">deadline</span></font><span class="p">);</span>

<a href="ref-programs-compute.html#%28reach._%28%28const%29%29%29" class="kd" data-pltdoc="x">const</a> <span class="p">[</span> <font class="badlink"><span class="nx">keepGoing</span></font><span class="p">,</span> <font class="badlink"><span class="nx">winner</span></font><span class="p">,</span> <font class="badlink"><span class="nx">ticketsSold</span></font> <span class="p">]</span> <font class="badlink"><span class="o">=</span></font>
  <span class="c1">// 2. While the deadline has yet to be reached</span>
  <a href="ref-programs-consensus.html#%28reach._%28%28parallel.Reduce%29%29%29" class="k" data-pltdoc="x">parallelReduce</a><span class="p">([</span> <a href="ref-programs-compute.html#%28reach._%28%28true%29%29%29" class="kc" data-pltdoc="x">true</a><span class="p">,</span> <font class="badlink"><span class="nx">Funder</span></font><span class="p">,</span> <span class="mi">0</span> <span class="p">])</span>
    <span class="p">.</span><a href="ref-programs-consensus.html#%28reach._%28%28invariant%29%29%29" class="k" data-pltdoc="x">invariant</a><span class="p">(</span><a href="ref-programs-compute.html#%28reach._%28%28balance%29%29%29" class="nb" data-pltdoc="x">balance</a><span class="p">()</span> <a href="ref-programs-compute.html#%28reach._%28%28~3d~3d%29%29%29" class="o" data-pltdoc="x">==</a> <font class="badlink"><span class="nx">ticketsSold</span></font> <a href="ref-programs-compute.html#%28reach._%28%28%2A%29%29%29" class="o" data-pltdoc="x">*</a> <font class="badlink"><span class="nx">ticketPrice</span></font><span class="p">)</span>
    <span class="p">.</span><a href="ref-programs-consensus.html#%28reach._%28%28while%29%29%29" class="k" data-pltdoc="x">while</a><span class="p">(</span><font class="badlink"><span class="nx">keepGoing</span></font><span class="p">)</span>
    <span class="p">.</span><a href="ref-programs-compute.html#%28reach._%28%28case%29%29%29" class="k" data-pltdoc="x">case</a><span class="p">(</span>
      <font class="badlink"><span class="nx">Buyer</span></font><span class="p">,</span>
      <span class="c1">// 2a. Allow a Buyer to purchase a ticket</span>
      <span class="p">(()</span> <a href="ref-programs-compute.html#%28reach._%28%28~3d._~3e%29%29%29" class="o" data-pltdoc="x">=&gt;</a> <span class="p">({</span>
        <font class="badlink"><span class="k">when</span></font><font class="badlink"><span class="o">:</span></font> <a href="ref-programs-local.html#%28reach._%28%28declassify%29%29%29" class="k" data-pltdoc="x">declassify</a><span class="p">(</span><a href="ref-programs-local.html#%28reach._%28%28interact%29%29%29" class="k" data-pltdoc="x">interact</a><span class="p">.</span><font class="badlink"><span class="nx">shouldBuyTicket</span></font><span class="p">(</span><font class="badlink"><span class="nx">ticketPrice</span></font><span class="p">)),</span>
      <span class="p">})),</span>
      <span class="p">(()</span> <a href="ref-programs-compute.html#%28reach._%28%28~3d._~3e%29%29%29" class="o" data-pltdoc="x">=&gt;</a> <font class="badlink"><span class="nx">ticketPrice</span></font><span class="p">),</span>
      <span class="p">(()</span> <a href="ref-programs-compute.html#%28reach._%28%28~3d._~3e%29%29%29" class="o" data-pltdoc="x">=&gt;</a> <span class="p">{</span>
        <a href="ref-programs-compute.html#%28reach._%28%28const%29%29%29" class="kd" data-pltdoc="x">const</a> <font class="badlink"><span class="nx">buyer</span></font> <font class="badlink"><span class="o">=</span></font> <a href="ref-programs-compute.html#%28reach._%28%28this%29%29%29" class="k" data-pltdoc="x">this</a><span class="p">;</span>
        <font class="badlink"><span class="nx">Buyer</span></font><span class="p">.</span><a href="ref-programs-step.html#%28reach._%28%28only%29%29%29" class="k" data-pltdoc="x">only</a><span class="p">(()</span> <a href="ref-programs-compute.html#%28reach._%28%28~3d._~3e%29%29%29" class="o" data-pltdoc="x">=&gt;</a> <a href="ref-programs-local.html#%28reach._%28%28interact%29%29%29" class="k" data-pltdoc="x">interact</a><span class="p">.</span><font class="badlink"><span class="nx">showPurchase</span></font><span class="p">(</span><font class="badlink"><span class="nx">buyer</span></font><span class="p">));</span>
        <span class="c1">// 2b. Keep track of last Buyer</span>
        <a href="ref-programs-compute.html#%28reach._%28%28return%29%29%29" class="k" data-pltdoc="x">return</a> <span class="p">[</span> <a href="ref-programs-compute.html#%28reach._%28%28true%29%29%29" class="kc" data-pltdoc="x">true</a><span class="p">,</span> <font class="badlink"><span class="nx">buyer</span></font><span class="p">,</span> <font class="badlink"><span class="nx">ticketsSold</span></font> <a href="ref-programs-compute.html#%28reach._%28%28%2B%29%29%29" class="o" data-pltdoc="x">+</a> <span class="mi">1</span> <span class="p">];</span>
      <span class="p">})</span>
    <span class="p">)</span>
    <span class="p">.</span><a href="ref-programs-step.html#%28reach._%28%28timeout%29%29%29" class="k" data-pltdoc="x">timeout</a><span class="p">(</span><font class="badlink"><span class="nx">deadline</span></font><span class="p">,</span> <span class="p">()</span> <a href="ref-programs-compute.html#%28reach._%28%28~3d._~3e%29%29%29" class="o" data-pltdoc="x">=&gt;</a> <span class="p">{</span>
      <a href="ref-programs-step.html#%28reach._%28%28race%29%29%29" class="k" data-pltdoc="x">race</a><span class="p">(</span><font class="badlink"><span class="nx">Buyer</span></font><span class="p">,</span> <font class="badlink"><span class="nx">Funder</span></font><span class="p">).</span><a href="ref-programs-step.html#%28reach._%28%28publish%29%29%29" class="k" data-pltdoc="x">publish</a><span class="p">();</span>
      <a href="ref-programs-compute.html#%28reach._%28%28return%29%29%29" class="k" data-pltdoc="x">return</a> <span class="p">[</span> <a href="ref-programs-compute.html#%28reach._%28%28false%29%29%29" class="kc" data-pltdoc="x">false</a><span class="p">,</span> <font class="badlink"><span class="nx">winner</span></font><span class="p">,</span> <font class="badlink"><span class="nx">ticketsSold</span></font> <span class="p">];</span> <span class="p">});</span>

<span class="c1">// 3. Transfer the balance to the last person who bought a ticket</span>
<a href="ref-programs-consensus.html#%28reach._%28%28transfer%29%29%29" class="k" data-pltdoc="x">transfer</a><span class="p">(</span><a href="ref-programs-compute.html#%28reach._%28%28balance%29%29%29" class="nb" data-pltdoc="x">balance</a><span class="p">()).</span><font class="badlink"><span class="nx">to</span></font><span class="p">(</span><font class="badlink"><span class="nx">winner</span></font><span class="p">);</span>
<a href="ref-programs-consensus.html#%28reach._%28%28commit%29%29%29" class="k" data-pltdoc="x">commit</a><span class="p">();</span>
</pre></div></p><p>We use <code class="highlight"><a href="ref-programs-consensus.html#%28reach._%28%28parallel.Reduce%29%29%29" class="k" data-pltdoc="x">parallelReduce</a></code> to allow Buyers to purchase tickets until
the deadline passes and accumulate the current winner. We maintain the invariant
that the balance must be equal to the number of tickets sold multiplied by the
ticket price.</p><h5>4.4.4<tt>&nbsp;</tt><a name="(part._workshop-fomo-ai)"></a>Assertion Insertion</h5><p>This program doesn&rsquo;t have many interesting properties to prove
as assertions, beyond the <a href="ref-model.html#%28tech._token._linearity._property%29" class="techoutside" data-pltdoc="x"><span class="techinside">token linearity property</span></a>. The
only property of interest is the <code class="highlight"><a href="ref-programs-consensus.html#%28reach._%28%28parallel.Reduce%29%29%29" class="k" data-pltdoc="x">parallelReduce</a></code> invariant
which states that the balance must be equal to the number of tickets
sold multiplied by the ticket price.</p><h5>4.4.5<tt>&nbsp;</tt><a name="(part._workshop-fomo-ii)"></a>Interaction Introduction</h5><p>Next, we need to insert the appropriate calls to <code class="highlight"><a href="ref-programs-local.html#%28reach._%28%28interact%29%29%29" class="k" data-pltdoc="x">interact</a></code>.
In this case, our program is very simple and we expect you&rsquo;ll do a great job without further discussion.</p><blockquote class="SCentered"><p><br/><br/><br/><span style="font-weight: bold">Stop!</span><br/>Insert <code class="highlight"><a href="ref-programs-local.html#%28reach._%28%28interact%29%29%29" class="k" data-pltdoc="x">interact</a></code> calls to the <a href="ref-model.html#%28tech._frontend%29" class="techoutside" data-pltdoc="x"><span class="techinside">frontend</span></a> into the program.<br/><br/><br/><br/></p></blockquote><p>Let&rsquo;s look at our whole program now:</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/workshop-fomo/index.rsh"><span class="stt">workshop-fomo/index.rsh</span></a><button class="btn" data-clipboard-text="'reach 0.1';
'use strict';

const CommonInterface = {
  // Show the address of winner
  showOutcome: Fun([Address], Null),
};

const FunderInterface = {
  ...CommonInterface,
  getParams: Fun([], Object({
    // relative deadline
    deadline: UInt,
    ticketPrice: UInt,
  })),
};

const BuyerInterface = {
  ...CommonInterface,
  shouldBuyTicket: Fun([UInt], Bool),
  showPurchase: Fun([Address], Null),
};

export const main = Reach.App(
  { },
  [
    Participant('Funder', FunderInterface),
    ParticipantClass('Buyer', BuyerInterface),
  ],
  (Funder, Buyer) =&gt; {

    // Helper to display results to everyone
    const showOutcome = (who) =&gt;
      each([Funder, Buyer], () =&gt; {
        interact.showOutcome(who); });

    // Have the funder publish the ticket price and deadline
    Funder.only(() =&gt; {
      const { ticketPrice, deadline } =
        declassify(interact.getParams());
    });
    Funder.publish(ticketPrice, deadline);

    // Until timeout, allow buyers to buy ticket
    const [ keepGoing, winner, ticketsSold ] =
      parallelReduce([ true, Funder, 0 ])
        .invariant(balance() == ticketsSold * ticketPrice)
        .while(keepGoing)
        .case(
          Buyer,
          () =&gt; ({
            when: declassify(interact.shouldBuyTicket(ticketPrice)),
          }),
          (_) =&gt; ticketPrice,
          (_) =&gt; {
            const buyer = this;
            Buyer.only(() =&gt; interact.showPurchase(buyer));
            return [ true, buyer, ticketsSold + 1 ];
          }
        )
        .timeout(relativeTime(deadline), () =&gt; {
          Anybody.publish();
          return [ false, winner, ticketsSold ]; });

    // Whoever buys last wins and receives balance
    transfer(balance()).to(winner);
    commit();
    showOutcome(winner);
  });"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span> <span class="mi">1</span>    <span class="s1">&#39;reach 0.1&#39;</span><span class="p">;</span>
 <span class="mi">2</span>    <span class="s1">&#39;use strict&#39;</span><span class="p">;</span>
 <span class="mi">3</span>    
 <span class="mi">4</span>    <a href="ref-programs-compute.html#%28reach._%28%28const%29%29%29" class="kd" data-pltdoc="x">const</a> <font class="badlink"><span class="nx">CommonInterface</span></font> <font class="badlink"><span class="o">=</span></font> <span class="p">{</span>
 <span class="mi">5</span>      <span class="c1">// Show the address of winner</span>
 <span class="mi">6</span>      <font class="badlink"><span class="nx">showOutcome</span></font><font class="badlink"><span class="o">:</span></font> <a href="ref-programs-compute.html#%28reach._%28%28.Fun%29%29%29" class="nb" data-pltdoc="x">Fun</a><span class="p">([</span><a href="ref-programs-compute.html#%28reach._%28%28.Address%29%29%29" class="nb" data-pltdoc="x">Address</a><span class="p">],</span> <a href="ref-programs-compute.html#%28reach._%28%28.Null%29%29%29" class="nb" data-pltdoc="x">Null</a><span class="p">),</span>
 <span class="mi">7</span>    <span class="p">};</span>
 <span class="mi">8</span>    
 <span class="mi">9</span>    <a href="ref-programs-compute.html#%28reach._%28%28const%29%29%29" class="kd" data-pltdoc="x">const</a> <font class="badlink"><span class="nx">FunderInterface</span></font> <font class="badlink"><span class="o">=</span></font> <span class="p">{</span>
<span class="mi">10</span>      <span class="p">...</span><font class="badlink"><span class="nx">CommonInterface</span></font><span class="p">,</span>
<span class="mi">11</span>      <font class="badlink"><span class="nx">getParams</span></font><font class="badlink"><span class="o">:</span></font> <a href="ref-programs-compute.html#%28reach._%28%28.Fun%29%29%29" class="nb" data-pltdoc="x">Fun</a><span class="p">([],</span> <a href="ref-programs-compute.html#%28reach._%28%28.Object%29%29%29" class="nb" data-pltdoc="x">Object</a><span class="p">({</span>
<span class="mi">12</span>        <span class="c1">// relative deadline</span>
<span class="mi">13</span>        <font class="badlink"><span class="nx">deadline</span></font><font class="badlink"><span class="o">:</span></font> <a href="ref-programs-compute.html#%28reach._%28%28.U.Int%29%29%29" class="nb" data-pltdoc="x">UInt</a><span class="p">,</span>
<span class="mi">14</span>        <font class="badlink"><span class="nx">ticketPrice</span></font><font class="badlink"><span class="o">:</span></font> <a href="ref-programs-compute.html#%28reach._%28%28.U.Int%29%29%29" class="nb" data-pltdoc="x">UInt</a><span class="p">,</span>
<span class="mi">15</span>      <span class="p">})),</span>
<span class="mi">16</span>    <span class="p">};</span>
<span class="mi">17</span>    
<span class="mi">18</span>    <a href="ref-programs-compute.html#%28reach._%28%28const%29%29%29" class="kd" data-pltdoc="x">const</a> <font class="badlink"><span class="nx">BuyerInterface</span></font> <font class="badlink"><span class="o">=</span></font> <span class="p">{</span>
<span class="mi">19</span>      <span class="p">...</span><font class="badlink"><span class="nx">CommonInterface</span></font><span class="p">,</span>
<span class="mi">20</span>      <font class="badlink"><span class="nx">shouldBuyTicket</span></font><font class="badlink"><span class="o">:</span></font> <a href="ref-programs-compute.html#%28reach._%28%28.Fun%29%29%29" class="nb" data-pltdoc="x">Fun</a><span class="p">([</span><a href="ref-programs-compute.html#%28reach._%28%28.U.Int%29%29%29" class="nb" data-pltdoc="x">UInt</a><span class="p">],</span> <a href="ref-programs-compute.html#%28reach._%28%28.Bool%29%29%29" class="nb" data-pltdoc="x">Bool</a><span class="p">),</span>
<span class="mi">21</span>      <font class="badlink"><span class="nx">showPurchase</span></font><font class="badlink"><span class="o">:</span></font> <a href="ref-programs-compute.html#%28reach._%28%28.Fun%29%29%29" class="nb" data-pltdoc="x">Fun</a><span class="p">([</span><a href="ref-programs-compute.html#%28reach._%28%28.Address%29%29%29" class="nb" data-pltdoc="x">Address</a><span class="p">],</span> <a href="ref-programs-compute.html#%28reach._%28%28.Null%29%29%29" class="nb" data-pltdoc="x">Null</a><span class="p">),</span>
<span class="mi">22</span>    <span class="p">};</span>
<span class="mi">23</span>    
<span class="mi">24</span>    <a href="ref-programs-module.html#%28reach._%28%28export%29%29%29" class="kd" data-pltdoc="x">export</a> <a href="ref-programs-compute.html#%28reach._%28%28const%29%29%29" class="kd" data-pltdoc="x">const</a> <font class="badlink"><span class="nx">main</span></font> <font class="badlink"><span class="o">=</span></font> <a href="ref-programs-module.html#%28reach._%28%28.Reach%29%29%29" class="nb" data-pltdoc="x">Reach</a><span class="p">.</span><a href="ref-programs-module.html#%28reach._%28%28.App%29%29%29" class="nb" data-pltdoc="x">App</a><span class="p">(</span>
<span class="mi">25</span>      <span class="p">{</span> <span class="p">},</span>
<span class="mi">26</span>      <span class="p">[</span>
<span class="mi">27</span>        <a href="ref-programs-appinit.html#%28reach._%28%28.Participant%29%29%29" class="nb" data-pltdoc="x">Participant</a><span class="p">(</span><span class="s1">&#39;Funder&#39;</span><span class="p">,</span> <font class="badlink"><span class="nx">FunderInterface</span></font><span class="p">),</span>
<span class="mi">28</span>        <a href="ref-programs-appinit.html#%28reach._%28%28.Participant.Class%29%29%29" class="nb" data-pltdoc="x">ParticipantClass</a><span class="p">(</span><span class="s1">&#39;Buyer&#39;</span><span class="p">,</span> <font class="badlink"><span class="nx">BuyerInterface</span></font><span class="p">),</span>
<span class="mi">29</span>      <span class="p">],</span>
<span class="mi">30</span>      <span class="p">(</span><font class="badlink"><span class="nx">Funder</span></font><span class="p">,</span> <font class="badlink"><span class="nx">Buyer</span></font><span class="p">)</span> <a href="ref-programs-compute.html#%28reach._%28%28~3d._~3e%29%29%29" class="o" data-pltdoc="x">=&gt;</a> <span class="p">{</span>
<span class="mi">31</span>    
<span class="mi">32</span>        <span class="c1">// Helper to display results to everyone</span>
<span class="mi">33</span>        <a href="ref-programs-compute.html#%28reach._%28%28const%29%29%29" class="kd" data-pltdoc="x">const</a> <font class="badlink"><span class="nx">showOutcome</span></font> <font class="badlink"><span class="o">=</span></font> <span class="p">(</span><font class="badlink"><span class="nx">who</span></font><span class="p">)</span> <a href="ref-programs-compute.html#%28reach._%28%28~3d._~3e%29%29%29" class="o" data-pltdoc="x">=&gt;</a>
<span class="mi">34</span>          <a href="ref-programs-step.html#%28reach._%28%28each%29%29%29" class="k" data-pltdoc="x">each</a><span class="p">([</span><font class="badlink"><span class="nx">Funder</span></font><span class="p">,</span> <font class="badlink"><span class="nx">Buyer</span></font><span class="p">],</span> <span class="p">()</span> <a href="ref-programs-compute.html#%28reach._%28%28~3d._~3e%29%29%29" class="o" data-pltdoc="x">=&gt;</a> <span class="p">{</span>
<span class="mi">35</span>            <a href="ref-programs-local.html#%28reach._%28%28interact%29%29%29" class="k" data-pltdoc="x">interact</a><span class="p">.</span><font class="badlink"><span class="nx">showOutcome</span></font><span class="p">(</span><font class="badlink"><span class="nx">who</span></font><span class="p">);</span> <span class="p">});</span>
<span class="mi">36</span>    
<span class="mi">37</span>        <span class="c1">// Have the funder publish the ticket price and deadline</span>
<span class="mi">38</span>        <font class="badlink"><span class="nx">Funder</span></font><span class="p">.</span><a href="ref-programs-step.html#%28reach._%28%28only%29%29%29" class="k" data-pltdoc="x">only</a><span class="p">(()</span> <a href="ref-programs-compute.html#%28reach._%28%28~3d._~3e%29%29%29" class="o" data-pltdoc="x">=&gt;</a> <span class="p">{</span>
<span class="mi">39</span>          <a href="ref-programs-compute.html#%28reach._%28%28const%29%29%29" class="kd" data-pltdoc="x">const</a> <span class="p">{</span> <font class="badlink"><span class="nx">ticketPrice</span></font><span class="p">,</span> <font class="badlink"><span class="nx">deadline</span></font> <span class="p">}</span> <font class="badlink"><span class="o">=</span></font>
<span class="mi">40</span>            <a href="ref-programs-local.html#%28reach._%28%28declassify%29%29%29" class="k" data-pltdoc="x">declassify</a><span class="p">(</span><a href="ref-programs-local.html#%28reach._%28%28interact%29%29%29" class="k" data-pltdoc="x">interact</a><span class="p">.</span><font class="badlink"><span class="nx">getParams</span></font><span class="p">());</span>
<span class="mi">41</span>        <span class="p">});</span>
<span class="mi">42</span>        <font class="badlink"><span class="nx">Funder</span></font><span class="p">.</span><a href="ref-programs-step.html#%28reach._%28%28publish%29%29%29" class="k" data-pltdoc="x">publish</a><span class="p">(</span><font class="badlink"><span class="nx">ticketPrice</span></font><span class="p">,</span> <font class="badlink"><span class="nx">deadline</span></font><span class="p">);</span>
<span class="mi">43</span>    
<span class="mi">44</span>        <span class="c1">// Until timeout, allow buyers to buy ticket</span>
<span class="mi">45</span>        <a href="ref-programs-compute.html#%28reach._%28%28const%29%29%29" class="kd" data-pltdoc="x">const</a> <span class="p">[</span> <font class="badlink"><span class="nx">keepGoing</span></font><span class="p">,</span> <font class="badlink"><span class="nx">winner</span></font><span class="p">,</span> <font class="badlink"><span class="nx">ticketsSold</span></font> <span class="p">]</span> <font class="badlink"><span class="o">=</span></font>
<span class="mi">46</span>          <a href="ref-programs-consensus.html#%28reach._%28%28parallel.Reduce%29%29%29" class="k" data-pltdoc="x">parallelReduce</a><span class="p">([</span> <a href="ref-programs-compute.html#%28reach._%28%28true%29%29%29" class="kc" data-pltdoc="x">true</a><span class="p">,</span> <font class="badlink"><span class="nx">Funder</span></font><span class="p">,</span> <span class="mi">0</span> <span class="p">])</span>
<span class="mi">47</span>            <span class="p">.</span><a href="ref-programs-consensus.html#%28reach._%28%28invariant%29%29%29" class="k" data-pltdoc="x">invariant</a><span class="p">(</span><a href="ref-programs-compute.html#%28reach._%28%28balance%29%29%29" class="nb" data-pltdoc="x">balance</a><span class="p">()</span> <a href="ref-programs-compute.html#%28reach._%28%28~3d~3d%29%29%29" class="o" data-pltdoc="x">==</a> <font class="badlink"><span class="nx">ticketsSold</span></font> <a href="ref-programs-compute.html#%28reach._%28%28%2A%29%29%29" class="o" data-pltdoc="x">*</a> <font class="badlink"><span class="nx">ticketPrice</span></font><span class="p">)</span>
<span class="mi">48</span>            <span class="p">.</span><a href="ref-programs-consensus.html#%28reach._%28%28while%29%29%29" class="k" data-pltdoc="x">while</a><span class="p">(</span><font class="badlink"><span class="nx">keepGoing</span></font><span class="p">)</span>
<span class="mi">49</span>            <span class="p">.</span><a href="ref-programs-compute.html#%28reach._%28%28case%29%29%29" class="k" data-pltdoc="x">case</a><span class="p">(</span>
<span class="mi">50</span>              <font class="badlink"><span class="nx">Buyer</span></font><span class="p">,</span>
<span class="mi">51</span>              <span class="p">()</span> <a href="ref-programs-compute.html#%28reach._%28%28~3d._~3e%29%29%29" class="o" data-pltdoc="x">=&gt;</a> <span class="p">({</span>
<span class="mi">52</span>                <font class="badlink"><span class="k">when</span></font><font class="badlink"><span class="o">:</span></font> <a href="ref-programs-local.html#%28reach._%28%28declassify%29%29%29" class="k" data-pltdoc="x">declassify</a><span class="p">(</span><a href="ref-programs-local.html#%28reach._%28%28interact%29%29%29" class="k" data-pltdoc="x">interact</a><span class="p">.</span><font class="badlink"><span class="nx">shouldBuyTicket</span></font><span class="p">(</span><font class="badlink"><span class="nx">ticketPrice</span></font><span class="p">)),</span>
<span class="mi">53</span>              <span class="p">}),</span>
<span class="mi">54</span>              <span class="p">(</span><font class="badlink"><span class="nx">_</span></font><span class="p">)</span> <a href="ref-programs-compute.html#%28reach._%28%28~3d._~3e%29%29%29" class="o" data-pltdoc="x">=&gt;</a> <font class="badlink"><span class="nx">ticketPrice</span></font><span class="p">,</span>
<span class="mi">55</span>              <span class="p">(</span><font class="badlink"><span class="nx">_</span></font><span class="p">)</span> <a href="ref-programs-compute.html#%28reach._%28%28~3d._~3e%29%29%29" class="o" data-pltdoc="x">=&gt;</a> <span class="p">{</span>
<span class="mi">56</span>                <a href="ref-programs-compute.html#%28reach._%28%28const%29%29%29" class="kd" data-pltdoc="x">const</a> <font class="badlink"><span class="nx">buyer</span></font> <font class="badlink"><span class="o">=</span></font> <a href="ref-programs-compute.html#%28reach._%28%28this%29%29%29" class="k" data-pltdoc="x">this</a><span class="p">;</span>
<span class="mi">57</span>                <font class="badlink"><span class="nx">Buyer</span></font><span class="p">.</span><a href="ref-programs-step.html#%28reach._%28%28only%29%29%29" class="k" data-pltdoc="x">only</a><span class="p">(()</span> <a href="ref-programs-compute.html#%28reach._%28%28~3d._~3e%29%29%29" class="o" data-pltdoc="x">=&gt;</a> <a href="ref-programs-local.html#%28reach._%28%28interact%29%29%29" class="k" data-pltdoc="x">interact</a><span class="p">.</span><font class="badlink"><span class="nx">showPurchase</span></font><span class="p">(</span><font class="badlink"><span class="nx">buyer</span></font><span class="p">));</span>
<span class="mi">58</span>                <a href="ref-programs-compute.html#%28reach._%28%28return%29%29%29" class="k" data-pltdoc="x">return</a> <span class="p">[</span> <a href="ref-programs-compute.html#%28reach._%28%28true%29%29%29" class="kc" data-pltdoc="x">true</a><span class="p">,</span> <font class="badlink"><span class="nx">buyer</span></font><span class="p">,</span> <font class="badlink"><span class="nx">ticketsSold</span></font> <a href="ref-programs-compute.html#%28reach._%28%28%2B%29%29%29" class="o" data-pltdoc="x">+</a> <span class="mi">1</span> <span class="p">];</span>
<span class="mi">59</span>              <span class="p">}</span>
<span class="mi">60</span>            <span class="p">)</span>
<span class="mi">61</span>            <span class="p">.</span><a href="ref-programs-step.html#%28reach._%28%28timeout%29%29%29" class="k" data-pltdoc="x">timeout</a><span class="p">(</span><a href="ref-programs-compute.html#%28reach._%28%28relative.Time%29%29%29" class="nx" data-pltdoc="x">relativeTime</a><span class="p">(</span><font class="badlink"><span class="nx">deadline</span></font><span class="p">),</span> <span class="p">()</span> <a href="ref-programs-compute.html#%28reach._%28%28~3d._~3e%29%29%29" class="o" data-pltdoc="x">=&gt;</a> <span class="p">{</span>
<span class="mi">62</span>              <a href="ref-programs-compute.html#%28reach._%28%28.Anybody%29%29%29" class="nb" data-pltdoc="x">Anybody</a><span class="p">.</span><a href="ref-programs-step.html#%28reach._%28%28publish%29%29%29" class="k" data-pltdoc="x">publish</a><span class="p">();</span>
<span class="mi">63</span>              <a href="ref-programs-compute.html#%28reach._%28%28return%29%29%29" class="k" data-pltdoc="x">return</a> <span class="p">[</span> <a href="ref-programs-compute.html#%28reach._%28%28false%29%29%29" class="kc" data-pltdoc="x">false</a><span class="p">,</span> <font class="badlink"><span class="nx">winner</span></font><span class="p">,</span> <font class="badlink"><span class="nx">ticketsSold</span></font> <span class="p">];</span> <span class="p">});</span>
<span class="mi">64</span>    
<span class="mi">65</span>        <span class="c1">// Whoever buys last wins and receives balance</span>
<span class="mi">66</span>        <a href="ref-programs-consensus.html#%28reach._%28%28transfer%29%29%29" class="k" data-pltdoc="x">transfer</a><span class="p">(</span><a href="ref-programs-compute.html#%28reach._%28%28balance%29%29%29" class="nb" data-pltdoc="x">balance</a><span class="p">()).</span><font class="badlink"><span class="nx">to</span></font><span class="p">(</span><font class="badlink"><span class="nx">winner</span></font><span class="p">);</span>
<span class="mi">67</span>        <a href="ref-programs-consensus.html#%28reach._%28%28commit%29%29%29" class="k" data-pltdoc="x">commit</a><span class="p">();</span>
<span class="mi">68</span>        <font class="badlink"><span class="nx">showOutcome</span></font><span class="p">(</span><font class="badlink"><span class="nx">winner</span></font><span class="p">);</span>
<span class="mi">69</span>      <span class="p">});</span>
</pre></div></div></p><h5>4.4.6<tt>&nbsp;</tt><a name="(part._workshop-fomo-de)"></a>Deployment Decisions</h5><p>Next, it is time to test our program. As usual, we&rsquo;ll present a completely
automated test deployment, rather than an interactive one.</p><p>The program is fairly straightfoward to test. We just create test accounts for
the Funder and any number of Buyers. The decision to purchase a ticket by
a Buyer will rely simply on generating a random boolean.</p><blockquote class="SCentered"><p><br/><br/><br/><span style="font-weight: bold">Stop!</span><br/>Decide how you will deploy and use this application.<br/><br/><br/><br/></p></blockquote><p>Here&rsquo;s the JavaScript <a href="ref-model.html#%28tech._frontend%29" class="techoutside" data-pltdoc="x"><span class="techinside">frontend</span></a> we wrote:</p><p><div class="SIntrapara"><table cellspacing="0" cellpadding="0" class="boxed"><tr><td><p><a href="https://github.com/reach-sh/reach-lang/blob/master/examples/workshop-fomo/index.mjs"><span class="stt">workshop-fomo/index.mjs</span></a><button class="btn" data-clipboard-text="import {loadStdlib} from '@reach-sh/stdlib';
import * as backend from './build/index.main.mjs';

const numOfBuyers = 10;

(async () =&gt; {
  const stdlib = await loadStdlib();
  const startingBalance = stdlib.parseCurrency(100);

  const accFunder = await stdlib.newTestAccount(startingBalance);
  const accBuyerArray = await Promise.all(
    Array.from({ length: numOfBuyers }, () =&gt;
      stdlib.newTestAccount(startingBalance)
    )
  );

  const ctcFunder = accFunder.deploy(backend);
  const ctcInfo   = ctcFunder.getInfo();

  const funderParams = {
    ticketPrice: stdlib.parseCurrency(5),
    deadline: 5,
  };

  await Promise.all([
    backend.Funder(ctcFunder, {
      showOutcome: (addr) =&gt; console.log(`Funder saw ${stdlib.formatAddress(addr)} won.`),
      getParams: () =&gt; funderParams,
    }),
  ].concat(
    accBuyerArray.map((accBuyer, i) =&gt; {
      const ctcBuyer = accBuyer.attach(backend, ctcInfo);
      return backend.Buyer(ctcBuyer, {
        showOutcome: (outcome) =&gt; {
          console.log(`Buyer ${i} saw they ${stdlib.addressEq(outcome, accBuyer) ? 'won' : 'lost'}.`);
        },
        shouldBuyTicket : () =&gt; Math.random() &lt; 0.5,
        showPurchase: (addr) =&gt; {
          if (stdlib.addressEq(addr, accBuyer)) {
            console.log(`Buyer ${i} bought a ticket.`);
          }
        }
      });
    })
  ));

})();"><img class="clippy" width="13" src="clippy.svg" alt="Copy to clipboard"> </img></button>&nbsp;</p></td></tr></table></div><div class="SIntrapara"><div class="highlight"><pre><span></span>  <span class="mi">1</span>    <a href="ref-programs-module.html#%28reach._%28%28import%29%29%29" class="kd" data-pltdoc="x">import</a> <span class="p">{</span><font class="badlink"><span class="nx">loadStdlib</span></font><span class="p">}</span> <a href="ref-programs-module.html#%28reach._%28%28from%29%29%29" class="kd" data-pltdoc="x">from</a> <span class="s1">&#39;@reach-sh/stdlib&#39;</span><span class="p">;</span>
  <span class="mi">2</span>    <a href="ref-programs-module.html#%28reach._%28%28import%29%29%29" class="kd" data-pltdoc="x">import</a> <a href="ref-programs-compute.html#%28reach._%28%28%2A%29%29%29" class="o" data-pltdoc="x">*</a> <font class="badlink"><span class="kd">as</span></font> <font class="badlink"><span class="nx">backend</span></font> <a href="ref-programs-module.html#%28reach._%28%28from%29%29%29" class="kd" data-pltdoc="x">from</a> <span class="s1">&#39;./build/index.main.mjs&#39;</span><span class="p">;</span>
  <span class="mi">3</span>    
  <span class="mi">4</span>    <a href="ref-programs-compute.html#%28reach._%28%28const%29%29%29" class="kd" data-pltdoc="x">const</a> <font class="badlink"><span class="nx">numOfBuyers</span></font> <font class="badlink"><span class="o">=</span></font> <span class="mi">10</span><span class="p">;</span>
  <span class="mi">5</span>    
  <span class="mi">6</span>    <span class="p">(</span><font class="badlink"><span class="nx">async</span></font> <span class="p">()</span> <a href="ref-programs-compute.html#%28reach._%28%28~3d._~3e%29%29%29" class="o" data-pltdoc="x">=&gt;</a> <span class="p">{</span>
  <span class="mi">7</span>      <a href="ref-programs-compute.html#%28reach._%28%28const%29%29%29" class="kd" data-pltdoc="x">const</a> <font class="badlink"><span class="nx">stdlib</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">await</span></font> <font class="badlink"><span class="nx">loadStdlib</span></font><span class="p">();</span>
  <span class="mi">8</span>      <a href="ref-programs-compute.html#%28reach._%28%28const%29%29%29" class="kd" data-pltdoc="x">const</a> <font class="badlink"><span class="nx">startingBalance</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">stdlib</span></font><span class="p">.</span><font class="badlink"><span class="nx">parseCurrency</span></font><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
  <span class="mi">9</span>    
 <span class="mi">10</span>      <a href="ref-programs-compute.html#%28reach._%28%28const%29%29%29" class="kd" data-pltdoc="x">const</a> <font class="badlink"><span class="nx">accFunder</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">await</span></font> <font class="badlink"><span class="nx">stdlib</span></font><span class="p">.</span><font class="badlink"><span class="nx">newTestAccount</span></font><span class="p">(</span><font class="badlink"><span class="nx">startingBalance</span></font><span class="p">);</span>
 <span class="mi">11</span>      <a href="ref-programs-compute.html#%28reach._%28%28const%29%29%29" class="kd" data-pltdoc="x">const</a> <font class="badlink"><span class="nx">accBuyerArray</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">await</span></font> <font class="badlink"><span class="nb">Promise</span></font><span class="p">.</span><a href="ref-programs-compute.html#%28reach._%28%28all%29%29%29" class="nx" data-pltdoc="x">all</a><span class="p">(</span>
 <span class="mi">12</span>        <a href="ref-programs-compute.html#%28reach._%28%28.Array%29%29%29" class="nb" data-pltdoc="x">Array</a><span class="p">.</span><a href="ref-programs-module.html#%28reach._%28%28from%29%29%29" class="kd" data-pltdoc="x">from</a><span class="p">({</span> <a href="ref-programs-compute.html#%28reach._%28%28length%29%29%29" class="nx" data-pltdoc="x">length</a><font class="badlink"><span class="o">:</span></font> <font class="badlink"><span class="nx">numOfBuyers</span></font> <span class="p">},</span> <span class="p">()</span> <a href="ref-programs-compute.html#%28reach._%28%28~3d._~3e%29%29%29" class="o" data-pltdoc="x">=&gt;</a>
 <span class="mi">13</span>          <font class="badlink"><span class="nx">stdlib</span></font><span class="p">.</span><font class="badlink"><span class="nx">newTestAccount</span></font><span class="p">(</span><font class="badlink"><span class="nx">startingBalance</span></font><span class="p">)</span>
 <span class="mi">14</span>        <span class="p">)</span>
 <span class="mi">15</span>      <span class="p">);</span>
 <span class="mi">16</span>    
 <span class="mi">17</span>      <a href="ref-programs-compute.html#%28reach._%28%28const%29%29%29" class="kd" data-pltdoc="x">const</a> <font class="badlink"><span class="nx">ctcFunder</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">accFunder</span></font><span class="p">.</span><a href="ref-programs-appinit.html#%28reach._%28%28deploy%29%29%29" class="nb" data-pltdoc="x">deploy</a><span class="p">(</span><font class="badlink"><span class="nx">backend</span></font><span class="p">);</span>
 <span class="mi">18</span>      <a href="ref-programs-compute.html#%28reach._%28%28const%29%29%29" class="kd" data-pltdoc="x">const</a> <font class="badlink"><span class="nx">ctcInfo</span></font>   <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">ctcFunder</span></font><span class="p">.</span><font class="badlink"><span class="nx">getInfo</span></font><span class="p">();</span>
 <span class="mi">19</span>    
 <span class="mi">20</span>      <a href="ref-programs-compute.html#%28reach._%28%28const%29%29%29" class="kd" data-pltdoc="x">const</a> <font class="badlink"><span class="nx">funderParams</span></font> <font class="badlink"><span class="o">=</span></font> <span class="p">{</span>
 <span class="mi">21</span>        <font class="badlink"><span class="nx">ticketPrice</span></font><font class="badlink"><span class="o">:</span></font> <font class="badlink"><span class="nx">stdlib</span></font><span class="p">.</span><font class="badlink"><span class="nx">parseCurrency</span></font><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
 <span class="mi">22</span>        <font class="badlink"><span class="nx">deadline</span></font><font class="badlink"><span class="o">:</span></font> <span class="mi">5</span><span class="p">,</span>
 <span class="mi">23</span>      <span class="p">};</span>
 <span class="mi">24</span>    
 <span class="mi">25</span>      <font class="badlink"><span class="nx">await</span></font> <font class="badlink"><span class="nb">Promise</span></font><span class="p">.</span><a href="ref-programs-compute.html#%28reach._%28%28all%29%29%29" class="nx" data-pltdoc="x">all</a><span class="p">([</span>
 <span class="mi">26</span>        <font class="badlink"><span class="nx">backend</span></font><span class="p">.</span><font class="badlink"><span class="nx">Funder</span></font><span class="p">(</span><font class="badlink"><span class="nx">ctcFunder</span></font><span class="p">,</span> <span class="p">{</span>
 <span class="mi">27</span>          <font class="badlink"><span class="nx">showOutcome</span></font><font class="badlink"><span class="o">:</span></font> <span class="p">(</span><font class="badlink"><span class="nx">addr</span></font><span class="p">)</span> <a href="ref-programs-compute.html#%28reach._%28%28~3d._~3e%29%29%29" class="o" data-pltdoc="x">=&gt;</a> <font class="badlink"><span class="nx">console</span></font><span class="p">.</span><font class="badlink"><span class="nx">log</span></font><span class="p">(</span><span class="sb">`Funder saw </span><span class="si">${</span><font class="badlink"><span class="nx">stdlib</span></font><span class="p">.</span><font class="badlink"><span class="nx">formatAddress</span></font><span class="p">(</span><font class="badlink"><span class="nx">addr</span></font><span class="p">)</span><span class="si">}</span><span class="sb"> won.`</span><span class="p">),</span>
 <span class="mi">28</span>          <font class="badlink"><span class="nx">getParams</span></font><font class="badlink"><span class="o">:</span></font> <span class="p">()</span> <a href="ref-programs-compute.html#%28reach._%28%28~3d._~3e%29%29%29" class="o" data-pltdoc="x">=&gt;</a> <font class="badlink"><span class="nx">funderParams</span></font><span class="p">,</span>
 <span class="mi">29</span>        <span class="p">}),</span>
 <span class="mi">30</span>      <span class="p">].</span><a href="ref-programs-compute.html#%28reach._%28%28concat%29%29%29" class="nx" data-pltdoc="x">concat</a><span class="p">(</span>
 <span class="mi">31</span>        <font class="badlink"><span class="nx">accBuyerArray</span></font><span class="p">.</span><a href="ref-programs-compute.html#%28reach._%28%28map%29%29%29" class="nx" data-pltdoc="x">map</a><span class="p">((</span><font class="badlink"><span class="nx">accBuyer</span></font><span class="p">,</span> <font class="badlink"><span class="nx">i</span></font><span class="p">)</span> <a href="ref-programs-compute.html#%28reach._%28%28~3d._~3e%29%29%29" class="o" data-pltdoc="x">=&gt;</a> <span class="p">{</span>
 <span class="mi">32</span>          <a href="ref-programs-compute.html#%28reach._%28%28const%29%29%29" class="kd" data-pltdoc="x">const</a> <font class="badlink"><span class="nx">ctcBuyer</span></font> <font class="badlink"><span class="o">=</span></font> <font class="badlink"><span class="nx">accBuyer</span></font><span class="p">.</span><font class="badlink"><span class="nx">attach</span></font><span class="p">(</span><font class="badlink"><span class="nx">backend</span></font><span class="p">,</span> <font class="badlink"><span class="nx">ctcInfo</span></font><span class="p">);</span>
 <span class="mi">33</span>          <a href="ref-programs-compute.html#%28reach._%28%28return%29%29%29" class="k" data-pltdoc="x">return</a> <font class="badlink"><span class="nx">backend</span></font><span class="p">.</span><font class="badlink"><span class="nx">Buyer</span></font><span class="p">(</span><font class="badlink"><span class="nx">ctcBuyer</span></font><span class="p">,</span> <span class="p">{</span>
 <span class="mi">34</span>            <font class="badlink"><span class="nx">showOutcome</span></font><font class="badlink"><span class="o">:</span></font> <span class="p">(</span><font class="badlink"><span class="nx">outcome</span></font><span class="p">)</span> <a href="ref-programs-compute.html#%28reach._%28%28~3d._~3e%29%29%29" class="o" data-pltdoc="x">=&gt;</a> <span class="p">{</span>
 <span class="mi">35</span>              <font class="badlink"><span class="nx">console</span></font><span class="p">.</span><font class="badlink"><span class="nx">log</span></font><span class="p">(</span><span class="sb">`Buyer </span><span class="si">${</span><font class="badlink"><span class="nx">i</span></font><span class="si">}</span><span class="sb"> saw they </span><span class="si">${</span><font class="badlink"><span class="nx">stdlib</span></font><span class="p">.</span><a href="ref-programs-compute.html#%28reach._%28%28address.Eq%29%29%29" class="nx" data-pltdoc="x">addressEq</a><span class="p">(</span><font class="badlink"><span class="nx">outcome</span></font><span class="p">,</span> <font class="badlink"><span class="nx">accBuyer</span></font><span class="p">)</span> <a href="ref-programs-compute.html#%28reach._%28%28~3f%29%29%29" class="o" data-pltdoc="x">?</a> <span class="s1">&#39;won&#39;</span> <font class="badlink"><span class="o">:</span></font> <span class="s1">&#39;lost&#39;</span><span class="si">}</span><span class="sb">.`</span><span class="p">);</span>
 <span class="mi">36</span>            <span class="p">},</span>
 <span class="mi">37</span>            <font class="badlink"><span class="nx">shouldBuyTicket</span></font> <font class="badlink"><span class="o">:</span></font> <span class="p">()</span> <a href="ref-programs-compute.html#%28reach._%28%28~3d._~3e%29%29%29" class="o" data-pltdoc="x">=&gt;</a> <font class="badlink"><span class="nb">Math</span></font><span class="p">.</span><font class="badlink"><span class="nx">random</span></font><span class="p">()</span> <a href="ref-programs-compute.html#%28reach._%28%28~3c%29%29%29" class="o" data-pltdoc="x">&lt;</a> <span class="mf">0.5</span><span class="p">,</span>
 <span class="mi">38</span>            <font class="badlink"><span class="nx">showPurchase</span></font><font class="badlink"><span class="o">:</span></font> <span class="p">(</span><font class="badlink"><span class="nx">addr</span></font><span class="p">)</span> <a href="ref-programs-compute.html#%28reach._%28%28~3d._~3e%29%29%29" class="o" data-pltdoc="x">=&gt;</a> <span class="p">{</span>
 <span class="mi">39</span>              <a href="ref-programs-compute.html#%28reach._%28%28if%29%29%29" class="k" data-pltdoc="x">if</a> <span class="p">(</span><font class="badlink"><span class="nx">stdlib</span></font><span class="p">.</span><a href="ref-programs-compute.html#%28reach._%28%28address.Eq%29%29%29" class="nx" data-pltdoc="x">addressEq</a><span class="p">(</span><font class="badlink"><span class="nx">addr</span></font><span class="p">,</span> <font class="badlink"><span class="nx">accBuyer</span></font><span class="p">))</span> <span class="p">{</span>
 <span class="mi">40</span>                <font class="badlink"><span class="nx">console</span></font><span class="p">.</span><font class="badlink"><span class="nx">log</span></font><span class="p">(</span><span class="sb">`Buyer </span><span class="si">${</span><font class="badlink"><span class="nx">i</span></font><span class="si">}</span><span class="sb"> bought a ticket.`</span><span class="p">);</span>
 <span class="mi">41</span>              <span class="p">}</span>
 <span class="mi">42</span>            <span class="p">}</span>
 <span class="mi">43</span>          <span class="p">});</span>
 <span class="mi">44</span>        <span class="p">})</span>
 <span class="mi">45</span>      <span class="p">));</span>
 <span class="mi">46</span>    
 <span class="mi">47</span>    <span class="p">})();</span>
</pre></div></div></p><p>Let&rsquo;s see what it looks like when we run the program:</p><p><table cellspacing="0" cellpadding="0" class="SVerbatim"><tr><td><p><span class="stt">$ ../reach run</span></p></td></tr><tr><td><p><span class="stt">Buyer 0 bought a ticket.</span></p></td></tr><tr><td><p><span class="stt">Buyer 3 bought a ticket.</span></p></td></tr><tr><td><p><span class="stt">...</span></p></td></tr><tr><td><p><span class="stt">Buyer 5 bought a ticket.</span></p></td></tr><tr><td><p><span class="stt">Buyer 9 bought a ticket.</span></p></td></tr><tr><td><p><span class="stt">Buyer 1 bought a ticket.</span></p></td></tr><tr><td><p><span class="stt">Funder saw 0x94CAC1b24C1f7b0EBAD4A51797dE5d59A39910C4 won.</span></p></td></tr><tr><td><p><span class="stt">Buyer 5 saw they lost.</span></p></td></tr><tr><td><p><span class="stt">Buyer 1 saw they won.</span></p></td></tr><tr><td><p><span class="stt">Buyer 6 saw they lost.</span></p></td></tr><tr><td><p><span class="stt">Buyer 0 saw they lost.</span></p></td></tr><tr><td><p><span class="stt">Buyer 4 saw they lost.</span></p></td></tr><tr><td><p><span class="stt">Buyer 8 saw they lost.</span></p></td></tr><tr><td><p><span class="stt">Buyer 2 saw they lost.</span></p></td></tr><tr><td><p><span class="stt">Buyer 7 saw they lost.</span></p></td></tr><tr><td><p><span class="stt">Buyer 3 saw they lost.</span></p></td></tr><tr><td><p><span class="stt">Buyer 9 saw they lost.</span></p></td></tr></table></p><h5>4.4.7<tt>&nbsp;</tt><a name="(part._workshop-fomo-dns)"></a>Discussion and Next Steps</h5><p>Great job!</p><p>If you found this workshop rewarding, please let us know on <a href="https://discord.gg/AZsgcXu">the Discord community</a>!</p><p>If you&rsquo;d like to make this application a little more interesting, maybe you&rsquo;d like
to extend this program to make the last <span class="stt">N</span> buyers split the winnings. Check out
<a href="workshop-fomo-generalized.html" data-pltdoc="x">Fear of Missing Out Generalized</a> for
our solution!</p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search docs..." title="Enter a search string to search the Reach documentation" onkeypress="return reach_DoSearch(event, this);"></form>&nbsp;&nbsp;<span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="workshop-trust-fund.html" title="backward to &quot;4.3 Workshop: Trust Fund&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="workshop.html" title="up to &quot;4 Workshop&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="workshop-fomo-generalized.html" title="forward to &quot;4.5 Workshop: Fear of Missing Out Generalized&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div><script src="reach-post.js"></script></body></html>